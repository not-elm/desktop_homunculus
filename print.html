<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MOD Manual</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MOD Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="desktop-homunculus-mod-development-manual"><a class="header" href="#desktop-homunculus-mod-development-manual">Desktop Homunculus MOD Development Manual</a></h1>
<p>Welcome to the comprehensive guide for developing MODs (modifications) for Desktop Homunculus! This manual will help you
create custom extensions, interactive interfaces, and automated behaviors for your desktop companion.</p>
<h2 id="about-desktop-homunculus"><a class="header" href="#about-desktop-homunculus">About Desktop Homunculus</a></h2>
<p>Desktop Homunculus is a cross-platform desktop mascot application that brings 3D VRM characters to life on your desktop.
These characters can interact with you through AI-powered conversations, respond to user input, and provide a
customizable digital companion experience.</p>
<h2 id="what-youll-learn"><a class="header" href="#what-youll-learn">What You'll Learn</a></h2>
<p>This manual covers everything you need to know to extend Desktop Homunculus with your own MODs:</p>
<ul>
<li><strong>Understanding MODs</strong>: Learn what MODs are and what they can do</li>
<li><strong>Creating MODs</strong>: Step-by-step guide to building your first MOD</li>
<li><strong>UI Development</strong>: Creating beautiful webview-based interfaces</li>
<li><strong>SDK Programming</strong>: Using the TypeScript SDK for advanced functionality</li>
<li><strong>API Integration</strong>: Communicating with Desktop Homunculus via HTTP APIs</li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>To follow this guide, you should have:</p>
<ul>
<li>Basic knowledge of HTML, CSS, and JavaScript</li>
<li>Familiarity with JSON configuration files</li>
<li>(Optional) TypeScript experience for advanced scripting</li>
<li>(Optional) Understanding of REST APIs for HTTP integration</li>
</ul>
<p>Let's start by understanding what MODs are and how they work in Desktop Homunculus!</p>
<hr />
<p><strong>Next</strong>: <a href="./what-is-mod.html">What is MOD?</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-mod"><a class="header" href="#what-is-mod">What is MOD?</a></h1>
<p>A <strong>MOD</strong> (modification) in Desktop Homunculus is a custom extension that allows you to add new functionality, user
interfaces, and behaviors to your desktop companion.
MODs are the primary way to customize and extend your Desktop Homunculus experience.</p>
<h2 id="core-capabilities"><a class="header" href="#core-capabilities">Core Capabilities</a></h2>
<p>MODs enable you to:</p>
<h3 id="-create-custom-user-interfaces"><a class="header" href="#-create-custom-user-interfaces">üé® <strong>Create Custom User Interfaces</strong></a></h3>
<ul>
<li>Build interactive HTML/CSS/JavaScript interfaces</li>
<li>Create floating windows, control panels, and overlays</li>
<li>Position UI elements relative to your VRM characters</li>
<li>Design transparent or styled windows that integrate seamlessly with your desktop</li>
</ul>
<h3 id="-control-vrm-characters"><a class="header" href="#-control-vrm-characters">ü§ñ <strong>Control VRM Characters</strong></a></h3>
<ul>
<li>Spawn, position, and animate VRM characters using 3D transforms</li>
<li>Make characters speak using VoiceVox integration and AI-powered chat</li>
<li>Play VRMA animations with precise control over repeat patterns and transitions</li>
<li>Access character bone hierarchy for detailed pose manipulation</li>
<li>Implement character state machines and automated routines</li>
</ul>
<h3 id="-add-interactive-features"><a class="header" href="#-add-interactive-features">üéÆ <strong>Add Interactive Features</strong></a></h3>
<ul>
<li>Respond to user clicks, drags, and keyboard input</li>
<li>Create context menus that appear when right-clicking characters</li>
<li>Add system tray menu items for quick access to MOD features</li>
<li>Implement real-time communication between different parts of your MOD</li>
</ul>
<h3 id="-integrate-external-services"><a class="header" href="#-integrate-external-services">üåê <strong>Integrate External Services</strong></a></h3>
<ul>
<li>Connect to web APIs and external services</li>
<li>Implement custom AI integrations beyond the built-in GPT support</li>
<li>Create bridges to other applications and services</li>
</ul>
<h3 id="-add-audio-and-visual-effects"><a class="header" href="#-add-audio-and-visual-effects">üéµ <strong>Add Audio and Visual Effects</strong></a></h3>
<ul>
<li>Play sound effects and background music</li>
<li>Display visual effects like stamps and animations</li>
<li>Control screen overlays and atmospheric effects</li>
<li>Synchronize effects with character actions and speech</li>
</ul>
<h2 id="mod-architecture"><a class="header" href="#mod-architecture">MOD Architecture</a></h2>
<p>MODs in Desktop Homunculus are built around several key components:</p>
<h3 id="-asset-based-structure"><a class="header" href="#-asset-based-structure">üìÅ <strong>Asset-Based Structure</strong></a></h3>
<p>MODs are organized as directories containing:</p>
<ul>
<li><strong>HTML files</strong> for user interfaces</li>
<li><strong>JavaScript/TypeScript files</strong> for scripting logic</li>
<li><strong>Images and icons</strong> for visual elements</li>
<li><strong>Audio files</strong> for sound effects</li>
<li><strong>Configuration files</strong> defining MOD behavior</li>
</ul>
<h3 id="-configuration-driven"><a class="header" href="#-configuration-driven">‚öôÔ∏è <strong>Configuration-Driven</strong></a></h3>
<p>MODs use a <code>mod.json</code> file to declare:</p>
<ul>
<li>Basic MOD metadata (name, version, author)</li>
<li>Menu items and user interface entry points</li>
<li>Startup scripts that run when the application starts</li>
<li>System integrations like tray menu items</li>
</ul>
<h3 id="-web-technology-based"><a class="header" href="#-web-technology-based">üåê <strong>Web Technology Based</strong></a></h3>
<p>MODs leverage familiar web technologies:</p>
<ul>
<li><strong>HTML/CSS</strong> for rich user interface design</li>
<li><strong>JavaScript/TypeScript</strong> for interactive behavior</li>
<li><strong>Standard web APIs</strong> for common functionality</li>
<li><strong>Custom SDK</strong> for Desktop Homunculus specific features</li>
</ul>
<h3 id="-real-time-communication"><a class="header" href="#-real-time-communication">üîÑ <strong>Real-Time Communication</strong></a></h3>
<p>MODs can communicate through:</p>
<ul>
<li><strong>HTTP REST API</strong> for request/response operations (localhost:3100)</li>
<li><strong>Server-Sent Events</strong> for real-time data streaming and character events</li>
<li><strong>Command system</strong> for cross-MOD communication via pub/sub patterns</li>
<li><strong>Event streams</strong> for reacting to user interactions (clicks, drags, state changes)</li>
<li><strong>Deno Runtime</strong> providing secure JavaScript/TypeScript execution environment</li>
</ul>
<h2 id="types-of-mods"><a class="header" href="#types-of-mods">Types of MODs</a></h2>
<h3 id="ui-focused-mods"><a class="header" href="#ui-focused-mods"><strong>UI-Focused MODs</strong></a></h3>
<p>Perfect for creators who want to build interactive interfaces:</p>
<ul>
<li><strong>Chat interfaces</strong> for conversing with AI-powered characters</li>
<li><strong>Settings panels</strong> for configuring application behavior</li>
<li><strong>Status displays</strong> showing real-time information</li>
<li><strong>Control dashboards</strong> for managing multiple characters</li>
</ul>
<h3 id="script-focused-mods"><a class="header" href="#script-focused-mods"><strong>Script-Focused MODs</strong></a></h3>
<p>Ideal for automating character behavior:</p>
<ul>
<li><strong>Automated routines</strong> that run on schedules</li>
<li><strong>Character AI behaviors</strong> that respond to events</li>
<li><strong>Data processing scripts</strong> that work with external APIs</li>
<li><strong>Background services</strong> that enhance the core experience</li>
</ul>
<h3 id="hybrid-mods"><a class="header" href="#hybrid-mods"><strong>Hybrid MODs</strong></a></h3>
<p>Combining UI and scripting for complex functionality:</p>
<ul>
<li><strong>Interactive games</strong> where users play with their characters</li>
<li><strong>Productivity tools</strong> that integrate with work workflows</li>
<li><strong>Entertainment systems</strong> providing music, videos, or stories</li>
<li><strong>Social features</strong> connecting with friends and communities</li>
</ul>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<p>Ready to create your first MOD? The journey involves:</p>
<ol>
<li><strong>Planning Your MOD</strong>: Define what you want to build and how users will interact with it</li>
<li><strong>Setting Up the Structure</strong>: Create the directory layout and configuration files</li>
<li><strong>Building the Interface</strong>: Design HTML/CSS interfaces if your MOD needs UI</li>
<li><strong>Adding Functionality</strong>: Write JavaScript/TypeScript code for interactive behavior</li>
</ol>
<p>The next section will guide you through creating your first MOD step by step.</p>
<hr />
<p><strong>Next</strong>: <a href="./mod-creation/index.html">MOD Creation Guide</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mod-creation-guide"><a class="header" href="#mod-creation-guide">MOD Creation Guide</a></h1>
<p>This comprehensive guide will walk you through creating your first MOD for Desktop Homunculus. By the end of this
section, you'll understand how to structure, configure, and develop fully functional MODs.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Creating a MOD involves several key steps:</p>
<ol>
<li><strong><a href="mod-creation/./directory-structure.html">Setting up the directory structure</a></strong> - Organizing your files properly</li>
<li><strong><a href="mod-creation/./mod-json.html">Writing the configuration file</a></strong> - Defining your MOD's metadata and behavior</li>
<li><strong><a href="mod-creation/./menus.html">Configuring menus</a></strong> - Adding entries to character context menus</li>
<li><strong><a href="mod-creation/./system-menus.html">Setting up system menus</a></strong> - Integrating with the system tray</li>
<li><strong><a href="mod-creation/./startup-scripts.html">Creating startup scripts</a></strong> - Running code when the application starts</li>
</ol>
<h2 id="quick-start-example"><a class="header" href="#quick-start-example">Quick Start Example</a></h2>
<p>Let's create a simple "Hello World" MOD to demonstrate the basic concepts:</p>
<h3 id="1-create-the-directory"><a class="header" href="#1-create-the-directory">1. Create the Directory</a></h3>
<pre><code>assets/mods/hello-world/
‚îú‚îÄ‚îÄ mod.json
‚îú‚îÄ‚îÄ index.html
‚îî‚îÄ‚îÄ icon.png
</code></pre>
<h3 id="2-basic-configuration-modjson"><a class="header" href="#2-basic-configuration-modjson">2. Basic Configuration (<code>mod.json</code>)</a></h3>
<pre><code class="language-json">{
  "name": "hello-world",
  "version": "1.0.0",
  "description": "A simple Hello World MOD",
  "author": "Your Name",
  "menus": [
    {
      "text": "Hello World",
      "thumbnail": "hello-world/icon.png",
      "webview": {
        "source": "hello-world/index.html",
        "resolution": [
          300,
          200
        ],
        "transparent": true,
        "position": {
          "offset": [
            -350,
            -200
          ]
        }
      }
    }
  ]
}
</code></pre>
<h3 id="3-simple-interface-indexhtml"><a class="header" href="#3-simple-interface-indexhtml">3. Simple Interface (<code>index.html</code>)</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello World&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            text-align: center;
        }

        button {
            padding: 10px 20px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #005999;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;Hello World!&lt;/h2&gt;
&lt;p&gt;This is your first Desktop Homunculus MOD.&lt;/p&gt;
&lt;button onclick="sayHello()"&gt;Click Me!&lt;/button&gt;

&lt;script&gt;
    function sayHello() {
        alert("Hello from your MOD!");
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="4-testing-your-mod"><a class="header" href="#4-testing-your-mod">4. Testing Your MOD</a></h3>
<ol>
<li>Place your MOD directory in <code>assets/mods/hello-world/</code></li>
<li>Restart Desktop Homunculus</li>
<li>Right-click on any VRM character</li>
<li>Select "Hello World" from the context menu</li>
<li>Your MOD interface should appear!</li>
</ol>
<h2 id="mod-loading-process"><a class="header" href="#mod-loading-process">MOD Loading Process</a></h2>
<p>Understanding how MODs are loaded helps you debug issues:</p>
<ol>
<li><strong>Discovery</strong>: Desktop Homunculus scans the <code>assets/mods/</code> directory on startup</li>
<li><strong>Configuration Parsing</strong>: Each <code>mod.json</code> file is read and validated</li>
<li><strong>Asset Registration</strong>: All files in MOD directories are registered as available assets</li>
<li><strong>Menu Integration</strong>: Menu items defined in configuration are added to the UI</li>
<li><strong>Script Execution</strong>: Any startup scripts are executed in the builtin Deno runtime</li>
</ol>
<h2 id="common-mod-patterns"><a class="header" href="#common-mod-patterns">Common MOD Patterns</a></h2>
<h3 id="ui-only-mods"><a class="header" href="#ui-only-mods">UI-Only MODs</a></h3>
<p>Perfect for simple interfaces and tools:</p>
<ul>
<li>Configuration panels</li>
<li>Information displays</li>
<li>Simple games or utilities</li>
</ul>
<h3 id="script-only-mods"><a class="header" href="#script-only-mods">Script-Only MODs</a></h3>
<p>Great for automation and background functionality:</p>
<ul>
<li>Automated character behaviors</li>
<li>External API integrations</li>
<li>Scheduled tasks and reminders</li>
</ul>
<h3 id="hybrid-mods-1"><a class="header" href="#hybrid-mods-1">Hybrid MODs</a></h3>
<p>Combining UI and scripting for complex functionality:</p>
<ul>
<li>Interactive applications</li>
<li>Real-time data displays</li>
<li>Multi-component systems</li>
</ul>
<h2 id="development-tips"><a class="header" href="#development-tips">Development Tips</a></h2>
<h3 id="hot-reload-support"><a class="header" href="#hot-reload-support">Hot Reload Support</a></h3>
<p>Desktop Homunculus supports hot reloading during development:</p>
<ul>
<li>Changes to HTML/CSS/JS files are automatically detected</li>
<li>Webviews refresh automatically when files change</li>
<li>No need to restart the application during development</li>
</ul>
<h3 id="asset-referencing"><a class="header" href="#asset-referencing">Asset Referencing</a></h3>
<p>Use the <code>mod-name/file-path</code> format for all asset references within your MOD:</p>
<ul>
<li><code>"hello-world/icon.png"</code> refers to <code>/assets/mods/hello-world/icon.png</code></li>
<li><code>"my-mod/sounds/click.mp3"</code> refers to <code>/assets/mods/my-mod/sounds/click.mp3</code></li>
<li>Paths are always relative to the <code>assets/mods/</code> directory</li>
</ul>
<h3 id="testing-strategy"><a class="header" href="#testing-strategy">Testing Strategy</a></h3>
<ul>
<li>Start with simple functionality and gradually add complexity</li>
<li>Test your MOD on different operating systems if possible</li>
<li>Verify that your MOD works with multiple VRM characters</li>
<li>Check that menu items appear correctly and webviews open properly</li>
</ul>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>Now that you understand the basics, dive deeper into each aspect:</p>
<ul>
<li><strong><a href="mod-creation/./directory-structure.html">Directory Structure</a></strong> - Learn about optimal file organization</li>
<li><strong><a href="mod-creation/./mod-json.html">Configuration File</a></strong> - Master the <code>mod.json</code> format</li>
<li><strong><a href="mod-creation/./menus.html">Menus</a></strong> - Create compelling menu experiences</li>
<li><strong><a href="mod-creation/./system-menus.html">System Menus</a></strong> - Integrate with the system tray</li>
<li><strong><a href="mod-creation/./startup-scripts.html">Startup Scripts</a></strong> - Automate functionality on app launch</li>
</ul>
<p>For more advanced functionality, explore:</p>
<ul>
<li><strong><a href="mod-creation/../webview-ui/index.html">Webview UI Development</a></strong> - Build sophisticated interfaces</li>
<li><strong><a href="mod-creation/../sdk/index.html">TypeScript SDK</a></strong> - Access powerful programming capabilities</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="directory-structure"><a class="header" href="#directory-structure">Directory Structure</a></h1>
<p>Proper organization of your MOD files is essential for maintainability and functionality. This page explains how to
structure your MOD directory for optimal development and deployment.</p>
<h2 id="basic-structure"><a class="header" href="#basic-structure">Basic Structure</a></h2>
<p>Every MOD must be placed in the <code>assets/mods/</code> directory with the following basic structure:</p>
<pre><code>assets/mods/your-mod-name/
‚îú‚îÄ‚îÄ mod.json                    # Required: MOD configuration
‚îú‚îÄ‚îÄ index.html                  # Optional: Main HTML interface
‚îú‚îÄ‚îÄ icon.png                    # Optional: MOD icon for menus
‚îî‚îÄ‚îÄ README.md                   # Optional: Documentation
</code></pre>
<h2 id="file-and-folder-requirements"><a class="header" href="#file-and-folder-requirements">File and Folder Requirements</a></h2>
<h3 id="required-files"><a class="header" href="#required-files">Required Files</a></h3>
<h4 id="modjson-required"><a class="header" href="#modjson-required"><code>mod.json</code> (Required)</a></h4>
<p>The configuration file that defines your MOD's metadata, menus, and behavior. This file must be present in the root of
your MOD directory.</p>
<pre><code class="language-json">{
  "name": "your-mod",
  "version": "1.0.0",
  "description": "Brief description of your MOD",
  "startupScripts": [
    "your-mod/scripts/index.js"
  ],
  "systemMenus": [
    {
      "text": "Open Dashboard",
      "shortcut": {
        "key": "KeyD",
        "modifiers": "ALT"
      },
      "script": "your-mod/scripts/dashboard.js",
      "webview": {
        "source": "your-mod/dashboard.html"
      }
    }
  ],
  "menus": [
    {
      "text": "Chat",
      "thumbnail": "my-mod/icons/chat.png",
      "webview": {
        "source": "my-mod/chat.html"
      }
    }
  ]
}
</code></pre>
<h2 id="platform-considerations"><a class="header" href="#platform-considerations">Platform Considerations</a></h2>
<h3 id="cross-platform-compatibility"><a class="header" href="#cross-platform-compatibility">Cross-Platform Compatibility</a></h3>
<ul>
<li>Use forward slashes (<code>/</code>) in all paths, even on Windows</li>
<li>Avoid platform-specific file names or characters</li>
</ul>
<h3 id="macos-specific"><a class="header" href="#macos-specific">macOS Specific</a></h3>
<ul>
<li>Avoid <code>.DS_Store</code> files by adding them to <code>.gitignore</code></li>
<li>Be aware of case-sensitive file systems on some macOS configurations</li>
</ul>
<h3 id="windows-specific"><a class="header" href="#windows-specific">Windows Specific</a></h3>
<ul>
<li>Long path names may cause issues on some Windows versions</li>
<li>Avoid reserved file names (<code>CON</code>, <code>PRN</code>, <code>AUX</code>, etc.)</li>
</ul>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<p>Once you have your directory structure set up, proceed to:</p>
<ul>
<li><strong><a href="mod-creation/./mod-json.html">Configuration File (mod.json)</a></strong> - Define your MOD's behavior and metadata</li>
<li><strong><a href="mod-creation/./menus.html">Menus Configuration</a></strong> - Add entries to character context menus</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration-file-modjson"><a class="header" href="#configuration-file-modjson">Configuration File (mod.json)</a></h1>
<p>The <code>mod.json</code> file is the heart of every MOD, defining its metadata, behavior, and integration points with Desktop
Homunculus. This configuration file must be present in the root directory of your MOD.</p>
<p>The metadata fields such as name and version are not currently in use, but they are expected to be utilized once the mod
registry becomes publicly available.</p>
<h2 id="basic-structure-1"><a class="header" href="#basic-structure-1">Basic Structure</a></h2>
<p>Here's the complete structure of a <code>mod.json</code> file with all possible fields:</p>
<pre><code class="language-json">{
  "name": "string",
  "version": "string",
  "description": "string",
  "author": "string",
  "license": "string",
  "startupScripts": [
    "array of script references"
  ],
  "systemMenus": [
    "array of system menu objects"
  ],
  "menus": [
    "array of context menu objects"
  ]
}
</code></pre>
<h2 id="required-fields"><a class="header" href="#required-fields">Required Fields</a></h2>
<h3 id="name-required"><a class="header" href="#name-required"><code>name</code> (Required)</a></h3>
<p>The unique identifier for your MOD. This must match your MOD directory name.</p>
<pre><code class="language-json">{
  "name": "my-awesome-mod"
}
</code></pre>
<p><strong>Rules:</strong></p>
<ul>
<li>Should be unique across all MODs</li>
</ul>
<h3 id="version-required"><a class="header" href="#version-required"><code>version</code> (Required)</a></h3>
<p>The version of your MOD using semantic versioning.</p>
<pre><code class="language-json">{
  "version": "1.0.0"
}
</code></pre>
<p><strong>Format:</strong> <code>MAJOR.MINOR.PATCH</code></p>
<ul>
<li><strong>MAJOR</strong>: Incompatible API changes</li>
<li><strong>MINOR</strong>: New functionality in a backwards-compatible manner</li>
<li><strong>PATCH</strong>: Backwards-compatible bug fixes</li>
</ul>
<h2 id="optional-metadata-fields"><a class="header" href="#optional-metadata-fields">Optional Metadata Fields</a></h2>
<h3 id="description-optional"><a class="header" href="#description-optional"><code>description</code> (Optional)</a></h3>
<p>A brief description of what your MOD does.</p>
<pre><code class="language-json">{
  "description": "A comprehensive chat interface with AI integration and custom themes"
}
</code></pre>
<h3 id="author-optional"><a class="header" href="#author-optional"><code>author</code> (Optional)</a></h3>
<p>The name or username of the MOD creator.</p>
<pre><code class="language-json">{
  "author": "YourUsername"
}
</code></pre>
<h3 id="license-optional"><a class="header" href="#license-optional"><code>license</code> (Optional)</a></h3>
<p>The license under which your MOD is released.</p>
<pre><code class="language-json">{
  "license": "MIT"
}
</code></pre>
<h2 id="functional-configuration-fields"><a class="header" href="#functional-configuration-fields">Functional Configuration Fields</a></h2>
<h3 id="startupscripts-optional"><a class="header" href="#startupscripts-optional"><code>startupScripts</code> (Optional)</a></h3>
<p>An array of JavaScript/TypeScript files to execute when Desktop Homunculus starts.</p>
<p><strong>Currently, the execution order is not guaranteed.</strong></p>
<pre><code class="language-json">{
  "startupScripts": [
    "my-mod/scripts/initialization.js",
    "my-mod/scripts/background-tasks.js"
  ]
}
</code></pre>
<p><strong>Important Notes:</strong></p>
<ul>
<li>Scripts are executed in the builtin Deno runtime</li>
<li>Scripts have access to the full TypeScript SDK via <code>Deno.api</code>
<ul>
<li>Please refer to the <a href="mod-creation/../sdk/index.html">SDK reference</a> for available functions</li>
</ul>
</li>
<li>Scripts run automatically on application startup</li>
<li>Use for initialization, background tasks, and automated behaviors</li>
<li>When a script is changed, it is hot-reloaded and executed again.</li>
</ul>
<h3 id="systemmenus-optional"><a class="header" href="#systemmenus-optional"><code>systemMenus</code> (Optional)</a></h3>
<p>Defines menu items that appear in the system tray menu.
Please refer to <a href="mod-creation/./system-menus.html">System Menus Configuration</a> for details.</p>
<pre><code class="language-json">{
  "systemMenus": [
    {
      "text": "Open Settings",
      "shortcut": {
        "key": "KeyS",
        "modifiers": [
          "Control",
          "Shift"
        ]
      },
      "webview": {
        "source": "my-mod/settings.html",
        "resolution": [
          400,
          300
        ]
      }
    },
    {
      "text": "Run Maintenance",
      "script": "my-mod/scripts/maintenance.js"
    }
  ]
}
</code></pre>
<h3 id="menus-optional"><a class="header" href="#menus-optional"><code>menus</code> (Optional)</a></h3>
<p>Defines menu items that appear when right-clicking on VRM characters.
Please refer to <a href="mod-creation/./menus.html">Menus Configuration</a> for details.</p>
<pre><code class="language-json">{
  "menus": [
    {
      "thumbnail": "my-mod/icons/chat.png",
      "text": "Start Chat",
      "webview": {
        "source": "my-mod/chat.html",
        "resolution": [
          500,
          400
        ],
        "transparent": true,
        "position": {
          "bone": "head",
          "offset": [
            0,
            100
          ],
          "tracking": true
        },
        "showToolbar": false
      }
    }
  ]
}
</code></pre>
<h2 id="complete-example"><a class="header" href="#complete-example">Complete Example</a></h2>
<p>Here's a comprehensive example showing all features:</p>
<pre><code class="language-json">{
  "name": "character-companion",
  "version": "2.1.0",
  "description": "A comprehensive character interaction system with chat, emotions, and activities",
  "author": "ModDeveloper",
  "license": "MIT",
  "startupScripts": [
    "character-companion/scripts/init.js",
    "character-companion/scripts/emotion-system.js",
    "character-companion/scripts/activity-scheduler.js"
  ],
  "systemMenus": [
    {
      "text": "Character Settings",
      "shortcut": {
        "key": "KeyP",
        "modifiers": [
          "Control"
        ]
      },
      "webview": {
        "source": "character-companion/ui/settings.html",
        "resolution": [
          600,
          400
        ]
      }
    },
    {
      "text": "Reset All Characters",
      "script": "character-companion/scripts/reset-characters.js"
    }
  ],
  "menus": [
    {
      "thumbnail": "character-companion/icons/chat.png",
      "text": "Chat",
      "webview": {
        "source": "character-companion/ui/chat.html",
        "resolution": [
          400,
          300
        ],
        "transparent": true,
        "position": {
          "bone": "head",
          "offset": [
            50,
            -50
          ],
          "tracking": true
        },
        "openSound": "character-companion/sounds/chat-open.mp3",
        "closeSound": "character-companion/sounds/chat-close.mp3"
      }
    },
    {
      "thumbnail": "character-companion/icons/activities.png",
      "text": "Activities",
      "webview": {
        "source": "character-companion/ui/activities.html",
        "resolution": [
          350,
          250
        ],
        "showToolbar": false
      }
    }
  ]
}
</code></pre>
<h2 id="next-steps-2"><a class="header" href="#next-steps-2">Next Steps</a></h2>
<p>Now that you understand <code>mod.json</code> configuration, learn about specific menu types:</p>
<ul>
<li><strong><a href="mod-creation/./menus.html">Menus Configuration</a></strong> - Character context menus</li>
<li><strong><a href="mod-creation/./system-menus.html">System Menus Configuration</a></strong> - System tray integration</li>
<li><strong><a href="mod-creation/./startup-scripts.html">Startup Scripts</a></strong> - Automated initialization</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="menus-configuration"><a class="header" href="#menus-configuration">Menus Configuration</a></h1>
<p>Context menus appear when users right-click on VRM characters, providing quick access to MOD functionality.
This page explains how to configure these menus in your <code>mod.json</code> file.</p>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>Context menus allow users to:</p>
<ul>
<li>Access MOD interfaces directly from VRM characters</li>
<li>Trigger scripts or actions specific to a character</li>
<li>Open webviews positioned relative to the character</li>
<li>Provide intuitive interaction points for character-based features</li>
</ul>
<h2 id="basic-menu-configuration"><a class="header" href="#basic-menu-configuration">Basic Menu Configuration</a></h2>
<p>Add menu items to the <code>menus</code> array in your <code>mod.json</code>:</p>
<pre><code class="language-json">{
  "menus": [
    {
      "text": "Chat",
      "thumbnail": "my-mod/icons/chat.png",
      "webview": {
        "source": "my-mod/chat.html",
        "resolution": [
          400,
          300
        ],
        "position": {
          "vrm": "CALLER",
          "bone": "head",
          "offset": [
            50,
            0
          ],
          "tracking": true
        },
        "sounds": {
          "open": "my-mod/sounds/open.mp3",
          "close": "my-mod/sounds/close.mp3"
        }
      }
    }
  ]
}
</code></pre>
<h2 id="menu-properties"><a class="header" href="#menu-properties">Menu Properties</a></h2>
<h3 id="text-required"><a class="header" href="#text-required"><code>text</code> (Required)</a></h3>
<p>The text displayed in the context menu.</p>
<h3 id="thumbnail-optional"><a class="header" href="#thumbnail-optional"><code>thumbnail</code> (Optional)</a></h3>
<p>An icon local(relative <code>assets/mods</code>) or remote path displayed next to the menu text.</p>
<p><strong>Specifications:</strong></p>
<ul>
<li><strong>Format</strong>: PNG, JPG.</li>
</ul>
<h3 id="script-optional"><a class="header" href="#script-optional"><code>script</code> (Optional)</a></h3>
<p>Executes a script when the menu item is clicked.
The script specified here runs in the built-in Deno runtime.</p>
<h3 id="webview-optional"><a class="header" href="#webview-optional"><code>webview</code> (Optional)</a></h3>
<p>Opens a user interface in a webview window:</p>
<pre><code class="language-json">{
  "webview": {
    "source": "my-mod/stats.html",
    "resolution": [
      300,
      400
    ],
    "transparent": true,
    "position": {
      "bone": "head",
      "offset": [
        50,
        0
      ],
      "tracking": true
    }
  }
}
</code></pre>
<h4 id="source"><a class="header" href="#source">source</a></h4>
<p>Webview local file path(relative to <code>assets/mods/</code>) or Remote URL.</p>
<h4 id="resolution"><a class="header" href="#resolution">resolution</a></h4>
<p>Set the size of the webview window.</p>
<h4 id="transparent"><a class="header" href="#transparent">transparent</a></h4>
<p>If true, the webview background is transparent.</p>
<blockquote>
<p>[!WARNING]
Currently, transparent areas block mouse events.</p>
</blockquote>
<blockquote>
<p>[!WARNING]
On Windows, transparency may not work correctly.</p>
</blockquote>
<h4 id="showtoolbar"><a class="header" href="#showtoolbar">showToolbar</a></h4>
<p>Hide or show the browser toolbar.
If not specified, the toolbar is shown by default.</p>
<h4 id="shadow-only-macos"><a class="header" href="#shadow-only-macos">shadow (only macOS)</a></h4>
<p>Enable display the window drop shadow on macOS.</p>
<h4 id="positioning-options"><a class="header" href="#positioning-options">Positioning Options</a></h4>
<h5 id="1-fixed-position"><a class="header" href="#1-fixed-position">1. Fixed Position</a></h5>
<p>Position the webview at specific screen coordinates:</p>
<pre><code class="language-json">{
  "webview": {
    "position": [
      100,
      200
    ]
  }
}
</code></pre>
<h5 id="2-vrm-relative-position"><a class="header" href="#2-vrm-relative-position">2. VRM-Relative Position</a></h5>
<p>Position the webview relative to a VRM avatar.</p>
<p>If not specified <code>bone</code>, it is calculated relative to the VRM root bone.</p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody>
<tr><td>bone</td><td>Place the webview relative to a specific bone of the VRM</td></tr>
<tr><td>offset</td><td>Specify the offset position from the bone (in screen coordinates)</td></tr>
<tr><td>tracking</td><td>If true, the webview follows the bone's movement</td></tr>
</tbody></table>
</div>
<pre><code class="language-json">{
  "webview": {
    "position": {
      "bone": "head",
      "offset": [
        0,
        100
      ],
      "tracking": true
    }
  }
}
</code></pre>
<h4 id="vrm-bone-options"><a class="header" href="#vrm-bone-options">VRM Bone Options</a></h4>
<p>You can attach webviews to various bones:</p>
<ul>
<li><strong>Body</strong>: <code>"hips"</code>, <code>"spine"</code>, <code>"chest"</code>, <code>"neck"</code>, <code>"head"</code></li>
<li><strong>Arms</strong>: <code>"leftShoulder"</code>, <code>"leftArm"</code>, <code>"leftForeArm"</code>, <code>"leftHand"</code></li>
<li><strong>Arms</strong>: <code>"rightShoulder"</code>, <code>"rightArm"</code>, <code>"rightForeArm"</code>, <code>"rightHand"</code></li>
<li><strong>Legs</strong>: <code>"leftUpLeg"</code>, <code>"leftLeg"</code>, <code>"leftFoot"</code></li>
<li><strong>Legs</strong>: <code>"rightUpLeg"</code>, <code>"rightLeg"</code>, <code>"rightFoot"</code></li>
</ul>
<h4 id="tracking"><a class="header" href="#tracking">tracking</a></h4>
<ul>
<li><strong><code>tracking: true</code></strong>: Webview follows the character as they move</li>
<li><strong><code>tracking: false</code></strong>: Webview stays at the initial position</li>
</ul>
<h4 id="sounds"><a class="header" href="#sounds">sounds</a></h4>
<p>Add audio feedback when webviews open and close:</p>
<pre><code class="language-json">{
  "webview": {
    "sounds": {
      "open": "my-mod/sounds/open.mp3",
      "close": "my-mod/sounds/close.mp3"
    }
  }
}
</code></pre>
<p><strong>Supported formats</strong>: MP3, WAV, OGG</p>
<h2 id="next-steps-3"><a class="header" href="#next-steps-3">Next Steps</a></h2>
<ul>
<li><strong><a href="mod-creation/./system-menus.html">System Menus Configuration</a></strong> - Learn about system tray integration</li>
<li><strong><a href="mod-creation/../webview-ui/index.html">Webview UI Development</a></strong> - Build sophisticated webview interfaces</li>
<li><strong><a href="mod-creation/../sdk/index.html">TypeScript SDK</a></strong> - Access advanced programming capabilities</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-menus-configuration"><a class="header" href="#system-menus-configuration">System Menus Configuration</a></h1>
<p>You can add custom system menus to the system tray, allowing users to access MOD functionality.</p>
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>System menus allow users to:</p>
<ul>
<li>Access MOD functionality from the system tray icon</li>
<li>Use keyboard shortcuts for quick actions</li>
<li>Open global interfaces not tied to specific characters</li>
<li>Trigger background scripts and maintenance tasks</li>
</ul>
<h2 id="basic-system-menu-configuration"><a class="header" href="#basic-system-menu-configuration">Basic System Menu Configuration</a></h2>
<p>Add system menu items to the <code>systemMenus</code> array in your <code>mod.json</code>:</p>
<pre><code class="language-json">{
  "systemMenus": [
    {
      "text": "Open Dashboard",
      "shortcut": {
        "key": "KeyD",
        "modifiers": "ALT"
      },
      "script": "my-mod/scripts/dashboard.js",
      "webview": {
        "source": "my-mod/dashboard.html",
        "position": [
          0,
          0
        ],
        "resolution": [
          800,
          600
        ],
        "showToolbar": true,
        "shadow": true,
        "sounds": {
          "open": "my-mod/sounds/dashboard-open.mp3",
          "close": "my-mod/sounds/dashboard-close.mp3"
        }
      }
      ]
    }
</code></pre>
<h2 id="system-menu-properties"><a class="header" href="#system-menu-properties">System Menu Properties</a></h2>
<h3 id="text-required-1"><a class="header" href="#text-required-1"><code>text</code> (Required)</a></h3>
<p>The display text that appears in the system tray menu.</p>
<h3 id="shortcut-optional"><a class="header" href="#shortcut-optional"><code>shortcut</code> (Optional)</a></h3>
<p>Keyboard shortcut for quick access to the menu item.</p>
<h4 id="available-keys"><a class="header" href="#available-keys">Available Keys</a></h4>
<p><strong>Letter Keys:</strong></p>
<ul>
<li><code>KeyA</code>, <code>KeyB</code>, <code>KeyC</code>, ..., <code>KeyZ</code></li>
</ul>
<p><strong>Number Keys:</strong></p>
<ul>
<li><code>Digit0</code>, <code>Digit1</code>, <code>Digit2</code>, ..., <code>Digit9</code></li>
</ul>
<p><strong>Function Keys:</strong></p>
<ul>
<li><code>F1</code>, <code>F2</code>, <code>F3</code>, ..., <code>F12</code></li>
</ul>
<p><strong>Special Keys:</strong></p>
<ul>
<li><code>Space</code>, <code>Enter</code>, <code>Escape</code>, <code>Tab</code>, <code>Backspace</code></li>
<li><code>ArrowUp</code>, <code>ArrowDown</code>, <code>ArrowLeft</code>, <code>ArrowRight</code></li>
</ul>
<h4 id="available-modifiers"><a class="header" href="#available-modifiers">Available Modifiers</a></h4>
<p><strong>Cross-Platform:</strong></p>
<ul>
<li><code>CMD_OR_CTRL</code>: Command key on macOS, Ctrl on Windows/Linux</li>
<li><code>SHIFT</code>: Shift key</li>
<li><code>ALT</code>: Alt key (Option on macOS)</li>
</ul>
<p><strong>Platform-Specific:</strong></p>
<ul>
<li><code>SUPER</code>: Windows key on Windows, Command on macOS</li>
<li><code>CTRL</code>: Control key (use <code>CMD_OR_CTRL</code> for cross-platform compatibility)</li>
</ul>
<h3 id="script-optional-1"><a class="header" href="#script-optional-1">script (Optional)</a></h3>
<p>A script file to execute when the menu item is clicked.
This script runs in the Deno runtime.</p>
<h3 id="webview-optional-1"><a class="header" href="#webview-optional-1">webview (Optional)</a></h3>
<p>A webview interface to open when the menu item is clicked.
The basic settings are the same as those described in <a href="mod-creation/./menus.html">menus</a>.</p>
<h2 id="next-steps-4"><a class="header" href="#next-steps-4">Next Steps</a></h2>
<ul>
<li><strong><a href="mod-creation/./startup-scripts.html">Startup Scripts</a></strong> - Learn about automatic script execution</li>
<li><strong><a href="mod-creation/../webview-ui/index.html">Webview UI Development</a></strong> - Build sophisticated interfaces</li>
<li><strong><a href="mod-creation/../sdk/index.html">TypeScript SDK</a></strong> - Access advanced programming capabilities</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="startup-scripts"><a class="header" href="#startup-scripts">Startup Scripts</a></h1>
<p>Startup scripts are JavaScript or TypeScript files that execute automatically when Desktop Homunculus launches.
These scripts run in a built-in Deno runtime environment and have full access to the TypeScript SDK, making them perfect
for initialization, automation, and background tasks.</p>
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>Startup scripts enable you to:</p>
<ul>
<li>Initialize your MOD's state and configuration</li>
<li>Set up background tasks and timers</li>
<li>Spawn default VRM characters</li>
<li>Register event handlers and callbacks</li>
<li>Perform data migration or cleanup tasks</li>
<li>Connect to external services and APIs</li>
</ul>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>Add startup scripts to the <code>startupScripts</code> array in your <code>mod.json</code>:</p>
<blockquote>
<p>[!WARNING]
The execution order of startup scripts is not guaranteed.</p>
</blockquote>
<pre><code class="language-json">{
  "startupScripts": [
    "my-mod/scripts/init.js",
    "my-mod/scripts/background-tasks.js",
    "my-mod/scripts/character-setup.js"
  ]
}
</code></pre>
<h2 id="deno-runtime-environment"><a class="header" href="#deno-runtime-environment">Deno Runtime Environment</a></h2>
<p>It runs in a built-in <a href="https://deno.com/">Deno</a> runtime.
This runtime allows you to use all Deno features, including unstable APIs like <a href="https://docs.deno.com/examples/cron/">
<code>Deno.cron</code></a>.</p>
<h3 id="sdk-access"><a class="header" href="#sdk-access">SDK Access</a></h3>
<p>The TypeScript SDK is available via <code>Deno.api</code>.
Please refer to the <a href="mod-creation/../sdk/index.html">SDK reference</a> for all available functions.</p>
<pre><code class="language-javascript">// Access VRM functions
const vrms = await Deno.api.vrm.findAll();

// Use preferences
await Deno.api.preferences.save('my-setting', 'value');

// Play effects
await Deno.api.effects.sound('my-mod/sounds/startup.mp3');
</code></pre>
<h2 id="common-startup-script-patterns"><a class="header" href="#common-startup-script-patterns">Common Startup Script Patterns</a></h2>
<h3 id="1-vrm-spawning"><a class="header" href="#1-vrm-spawning">1. VRM Spawning</a></h3>
<p>Set up your MOD's initial state:</p>
<pre><code class="language-javascript">(async () =&gt; {
    const elmer = await Deno.api.Vrm.spawn("elmer/Elmer.vrm");
    console.log(await elmer.entity);
    console.log(await elmer.name());
    console.log(await elmer.state());
    await Deno.api.gpt.chat('Hello, Elmer!', {
        vrm: elmer.entity,
    });
})();
</code></pre>
<h3 id="2-background-tasks"><a class="header" href="#2-background-tasks">2. Background Tasks</a></h3>
<p>You can use <code>setInterval</code> or <code>setTimeout</code> for periodic tasks.
Also, you can use <a href="https://docs.deno.com/examples/cron/"><code>Deno.cron</code></a> for cron-style scheduling.</p>
<pre><code class="language-javascript">Deno.cron("Log a message", "* * * * *", () =&gt; {
    console.log("This will print once a minute.");
});
</code></pre>
<h3 id="3-listen-commands-that-sent-by-other-processes"><a class="header" href="#3-listen-commands-that-sent-by-other-processes">3. Listen Commands that sent by other processes</a></h3>
<p>You can listen to commands sent by other processes.
This allows integration with external applications.</p>
<p>For more details on commands, refer to the <a href="mod-creation/../sdk/commands/index.html">commands documentation</a>.</p>
<pre><code class="language-javascript">
Deno.api.commands.stream('command-name', async (data) =&gt; {
    console.log("Received command data:", data);
});
</code></pre>
<h2 id="next-steps-5"><a class="header" href="#next-steps-5">Next Steps</a></h2>
<ul>
<li><strong><a href="mod-creation/../webview-ui/index.html">Webview UI Development</a></strong> - Create user interfaces for your MOD</li>
<li><strong><a href="mod-creation/../sdk/index.html">TypeScript SDK Reference</a></strong> - Explore all available API functions</li>
<li><strong><a href="mod-creation/../best-practices/index.html">Best Practices</a></strong> - Learn optimization and error handling techniques</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-convert-vrm0x-to-vrm10"><a class="header" href="#how-to-convert-vrm0x-to-vrm10">How to Convert VRM0.X to VRM1.0</a></h1>
<p>VRM comes in two versions: <code>0.X</code> and <code>1.0</code>, and this application only supports <code>1.0</code>.
This section explains how to convert from <code>0.X</code> to <code>1.0</code>.</p>
<h2 id="install-unity"><a class="header" href="#install-unity">Install Unity</a></h2>
<p>Please install the latest version of <a href="https://docs.unity3d.com/hub/manual/InstallHub.html">Unity Hub</a>.</p>
<h2 id="install-univrm"><a class="header" href="#install-univrm">Install UniVRM</a></h2>
<p>Install the latest version of <a href="https://github.com/vrm-c/UniVRM/releases">UniVRM</a>.</p>
<h2 id="convert-vrm0-to-vrm1"><a class="header" href="#convert-vrm0-to-vrm1">Convert VRM0 to VRM1</a></h2>
<p>Click on <code>VRM1</code> after selecting the VRM you want to convert.
<img src="asset-preparation/uni-vrm1.png" alt="img.png" /></p>
<p>Selecting <code>Export VRM1</code> from the menu displays the following dialog.
Click <code>Export</code>, and then simply follow the prompts to complete the export.</p>
<p><img src="asset-preparation/uni-vrm2.png" alt="img.png" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-create-vrma"><a class="header" href="#how-to-create-vrma">How to Create VRMA</a></h1>
<p>VRMA is an animation file format used for retargeting to VRM.
It is a relatively new format, and currently there are few tools that support it.</p>
<p>As far as I know, Blender's <a href="https://vrm-addon-for-blender.info/en/">VRM add-on for Blender</a> is recommended because it
also allows configuration of facial expressions.</p>
<p>The application's built-in animations are also created using this
add-on, but since the T-Pose of animations exported from Blender differs from that of other exporters, there is a high
risk that animation interpolation may break. Therefore, I recommend exporting from this add-on whenever possible. For
more information on why differing T-poses can break animation interpolation,
see <a href="https://github.com/not-elm/bevy_vrm1/issues/32">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="openapi-integration"><a class="header" href="#openapi-integration">OpenAPI Integration</a></h1>
<p>Desktop Homunculus provides a comprehensive HTTP REST API that allows you to integrate with external applications and
services.
This OpenAPI-compliant interface enables you to control VRM characters, manage webviews, and access all core
functionality programmatically.</p>
<h2 id="openapi-specification"><a class="header" href="#openapi-specification">OpenAPI Specification</a></h2>
<p>Check out the <a href="openapi/./open-api.html">OpenAPI specification</a>.</p>
<h2 id="next-steps-6"><a class="header" href="#next-steps-6">Next Steps</a></h2>
<ol>
<li><strong><a href="openapi/./reference.html">Explore the Full API Reference</a></strong> - Detailed endpoint documentation</li>
<li><strong><a href="openapi/./http-communication.html">HTTP Communication Guide</a></strong> - Implementation patterns and best practices</li>
<li><strong><a href="openapi/../sdk/index.html">TypeScript SDK</a></strong> - Type-safe alternative for web-based MODs</li>
</ol>
<p>The OpenAPI specification provides the foundation for building powerful integrations that extend Desktop Homunculus
beyond its core functionality, enabling limitless possibilities for character interaction and automation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript-sdk-reference"><a class="header" href="#typescript-sdk-reference">TypeScript SDK Reference</a></h1>
<p>The Desktop Homunculus TypeScript SDK provides comprehensive APIs for building sophisticated MODs that interact with 3D
VRM characters, AI systems, and immersive user interfaces. This reference covers all available functions, types, and
usage patterns.</p>
<h2 id="sdk-overview"><a class="header" href="#sdk-overview">SDK Overview</a></h2>
<p>The SDK is organized into focused namespaces, each handling specific aspects of the Desktop Homunculus ecosystem. All
APIs are designed to be type-safe, well-documented, and easy to use in both startup scripts and webview interfaces.</p>
<h3 id="core-features"><a class="header" href="#core-features">Core Features</a></h3>
<ul>
<li><strong>VRM Character Management</strong> - Load, control, and animate 3D VRM avatars</li>
<li><strong>AI Integration</strong> - GPT-powered chat with customizable personalities and voice synthesis</li>
<li><strong>3D World Interaction</strong> - Entity Component System for managing objects in 3D space</li>
<li><strong>UI and Webview System</strong> - Embed HTML interfaces in 3D space with character attachment</li>
<li><strong>Effects and Media</strong> - Visual effects, sound playback, and multi-monitor support</li>
<li><strong>Cross-Process Communication</strong> - Real-time messaging between MOD components</li>
<li><strong>Persistent Data Storage</strong> - Type-safe preference storage and state management</li>
</ul>
<h2 id="getting-started-1"><a class="header" href="#getting-started-1">Getting Started</a></h2>
<h3 id="installation-and-import"><a class="header" href="#installation-and-import">Installation and Import</a></h3>
<p>In startup scripts, the SDK is available via the global <code>Deno.api</code> object:</p>
<pre><code class="language-javascript">// Access SDK functions in startup scripts
const vrms = await Deno.api.vrm.findAll();
await Deno.api.gpt.chat('Hello!', {vrm: vrms[0].entity});
</code></pre>
<p>In webviews, use direct HTTP API calls or the webview bridge (when available):</p>
<pre><code class="language-javascript">// HTTP API approach (recommended)
const response = await fetch('http://localhost:3100/vrm');
const vrms = await response.json();

// SDK bridge approach (limited availability)
if (window.DESKTOP_HOMUNCULUS_API) {
    const vrms = await window.DESKTOP_HOMUNCULUS_API.vrm.findAll();
}
</code></pre>
<h3 id="quick-start-example-1"><a class="header" href="#quick-start-example-1">Quick Start Example</a></h3>
<pre><code class="language-typescript">// Basic MOD interaction example
async function createInteractiveCharacter() {
    // Spawn a VRM character
    const character = await Deno.api.vrm.spawn('my-mod::characters/assistant.vrm', {
        transform: {
            translation: [100, 0, 0],
            rotation: [0, 0, 0, 1],
            scale: [1, 1, 1]
        }
    });

    // Setup AI personality
    await Deno.api.gpt.saveSystemPrompt(
        'You are a friendly assistant who loves to help users.',
        {vrm: character.entity}
    );

    // Create floating interface
    await Deno.api.webviews.open('my-mod::chat.html', {
        position: {
            vrm: character.entity,
            bone: 'head',
            offset: [0, 100],
            tracking: true
        },
        transparent: true,
        showToolbar: false
    });

    // Setup interaction events
    const events = character.events();
    events.on('pointer-click', async () =&gt; {
        await Deno.api.effects.sound('my-mod::sounds/greeting.mp3');
        await Deno.api.gpt.chat('Hello! How can I help you today?', {
            vrm: character.entity,
            speaker: 1
        });
    });
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entities-api"><a class="header" href="#entities-api">Entities API</a></h1>
<p>The Entities API provides core functionality for managing ECS (Entity Component System) entities.
In Desktop Homunculus, everything is represented as entities in Bevy's ECS system - including VRM models, bones, UI
elements, and other game objects.</p>
<h2 id="key-concepts"><a class="header" href="#key-concepts">Key Concepts</a></h2>
<ul>
<li><strong>Entity</strong>: A unique identifier in the ECS system</li>
<li><strong>Name</strong>: Human-readable identifier for entities</li>
<li><strong>Transform</strong>: Position, rotation, and scale data in 3D space</li>
<li><strong>Hierarchy</strong>: Entities can have parent-child relationships</li>
</ul>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<ul>
<li><a href="sdk/entities/./findByName.html"><code>findByName()</code></a> - Find entities by their name</li>
<li><a href="sdk/entities/./name.html"><code>name()</code></a> - Get the human-readable name of an entity</li>
<li><a href="sdk/entities/./transform.html"><code>transform()</code></a> - Get entity transform (position, rotation, scale)</li>
<li><a href="sdk/entities/./setTransform.html"><code>setTransform()</code></a> - Update entity transform</li>
</ul>
<h2 id="quick-example"><a class="header" href="#quick-example">Quick Example</a></h2>
<pre><code class="language-typescript">// Find a VRM entity by name
const vrmEntity = await entities.findByName("MyCharacter");

// Get the current transform (position, rotation, scale)
const transform = await entities.transform(vrmEntity);
console.log("Position:", transform.translation);

// Move the VRM to a new position
await entities.setTransform(vrmEntity, {
    translation: [100, 0, 50]
});

// Find a bone within a specific VRM
const headBone = await entities.findByName("head", {root: vrmEntity});
</code></pre>
<h2 id="common-use-cases"><a class="header" href="#common-use-cases">Common Use Cases</a></h2>
<ul>
<li><strong>VRM Management</strong>: Control character position and orientation</li>
<li><strong>Bone Manipulation</strong>: Access and modify VRM bone transforms</li>
<li><strong>Object Positioning</strong>: Place and move objects in 3D space</li>
<li><strong>Hierarchy Navigation</strong>: Find children and parent entities</li>
<li><strong>Animation Control</strong>: Modify transforms for custom animations</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="finding-entities-by-name"><a class="header" href="#finding-entities-by-name">Finding Entities by Name</a></h1>
<p>Finds an entity by its name, optionally within a specific parent entity.</p>
<p>This is the primary method for locating entities in the ECS system. Names are unique within their scope (global or under
a specific parent). Every VRM model, bone, UI element, and other game objects can be found using their human-readable
names.</p>
<h2 id="parameters"><a class="header" href="#parameters">Parameters</a></h2>
<ul>
<li><code>name</code>: The name of the entity to find</li>
<li><code>options</code> (optional): Search parameters object
<ul>
<li><code>root</code> (optional): Parent entity to search within</li>
</ul>
</li>
</ul>
<h2 id="returns"><a class="header" href="#returns">Returns</a></h2>
<p>Promise that resolves to the entity ID (number). Throws an error if no entity with the given name is found.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="basic-entity-finding"><a class="header" href="#basic-entity-finding">Basic Entity Finding</a></h3>
<pre><code class="language-typescript">// Find a VRM character globally
const vrmEntity = await entities.findByName("MyCharacter");
console.log("Found VRM entity:", vrmEntity);

// Find UI elements
const settingsPanel = await entities.findByName("SettingsPanel");
const chatWindow = await entities.findByName("ChatWindow");
</code></pre>
<h3 id="finding-child-entities"><a class="header" href="#finding-child-entities">Finding Child Entities</a></h3>
<pre><code class="language-typescript">// Find a bone within a specific VRM
const vrmEntity = await entities.findByName("MyCharacter");
const headBone = await entities.findByName("head", {
    root: vrmEntity
});
console.log("Found head bone:", headBone);

// Find hand bones
const leftHand = await entities.findByName("leftHand", { root: vrmEntity });
const rightHand = await entities.findByName("rightHand", { root: vrmEntity });
</code></pre>
<h2 id="related-functions"><a class="header" href="#related-functions">Related Functions</a></h2>
<ul>
<li><a href="sdk/entities/./name.html"><code>name()</code></a> - Get the name of an entity</li>
<li><a href="sdk/entities/./transform.html"><code>transform()</code></a> - Get entity position/rotation/scale</li>
<li><a href="sdk/entities/./setTransform.html"><code>setTransform()</code></a> - Update entity transform</li>
<li><a href="sdk/entities/../vrm/findByName.html"><code>Vrm.findByName()</code></a> - Find VRM models specifically</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="name"><a class="header" href="#name">Name</a></h1>
<p>Gets the human-readable name of an entity.</p>
<p>Most entities in Desktop Homunculus have names that make them easier to identify and work with. VRM models use their
character names, bones use standard bone names like "head", "leftHand", etc., and UI elements have descriptive names for
their functions.</p>
<h2 id="parameters-1"><a class="header" href="#parameters-1">Parameters</a></h2>
<ul>
<li><code>entity</code>: The entity ID to get the name for</li>
</ul>
<h2 id="returns-1"><a class="header" href="#returns-1">Returns</a></h2>
<p>Promise that resolves to the entity's name as a string.</p>
<h2 id="examples-1"><a class="header" href="#examples-1">Examples</a></h2>
<h3 id="basic-name-retrieval"><a class="header" href="#basic-name-retrieval">Basic Name Retrieval</a></h3>
<pre><code class="language-typescript">// Get VRM character name
const vrmEntity = await entities.findByName("MyCharacter");
const name = await entities.name(vrmEntity);
console.log("Entity name:", name); // "MyCharacter"

// Get bone names
const headBone = await entities.findByName("head", {root: vrmEntity});
const boneName = await entities.name(headBone);
console.log("Bone name:", boneName); // "head"

// Get UI element names
const settingsPanel = await entities.findByName("SettingsPanel");
const panelName = await entities.name(settingsPanel);
console.log("Panel name:", panelName); // "SettingsPanel"
</code></pre>
<h2 id="related-functions-1"><a class="header" href="#related-functions-1">Related Functions</a></h2>
<ul>
<li><a href="sdk/entities/./findByName.html"><code>findByName()</code></a> - Find entities by their names</li>
<li><a href="sdk/entities/./transform.html"><code>transform()</code></a> - Get entity position/rotation/scale</li>
<li><a href="sdk/entities/./setTransform.html"><code>setTransform()</code></a> - Update entity transform</li>
<li><a href="sdk/entities/../vrm/name.html"><code>Vrm.name()</code></a> - Get VRM character names specifically</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transform"><a class="header" href="#transform">Transform</a></h1>
<p>The transform defines where the entity is positioned in 3D space, how it's rotated, and its scale factor. This is
fundamental for understanding entity positioning and for making positioning decisions.</p>
<h2 id="entitiestransform"><a class="header" href="#entitiestransform">entities.transform()</a></h2>
<p>Get the current transform (position, rotation, scale) of an entity.</p>
<h3 id="parameters-2"><a class="header" href="#parameters-2">Parameters</a></h3>
<ul>
<li><code>entity</code>: The entity ID to get the transform for</li>
</ul>
<h3 id="returns-2"><a class="header" href="#returns-2">Returns</a></h3>
<p>Promise that resolves to a <code>Transform</code> object containing:</p>
<ul>
<li><code>translation</code>: Position in world space [x, y, z]</li>
<li><code>rotation</code>: Rotation as quaternion [x, y, z, w]</li>
<li><code>scale</code>: Scale factor [x, y, z]</li>
</ul>
<h2 id="entitiessettransform"><a class="header" href="#entitiessettransform">entities.setTransform()</a></h2>
<p>Update the transform (position, rotation, scale) of an entity.</p>
<h3 id="parameters-3"><a class="header" href="#parameters-3">Parameters</a></h3>
<ul>
<li><code>entity</code>: The entity ID to update</li>
<li><code>transform</code>: Partial transform data with the values to update</li>
</ul>
<h2 id="examples-2"><a class="header" href="#examples-2">Examples</a></h2>
<h3 id="basic-transform-retrieval"><a class="header" href="#basic-transform-retrieval">Basic Transform Retrieval</a></h3>
<pre><code class="language-typescript">// Get VRM character transform
const vrmEntity = await entities.findByName("MyCharacter");
const transform = await entities.transform(vrmEntity);

console.log("Position:", transform.translation);
console.log("Rotation:", transform.rotation);
console.log("Scale:", transform.scale);

// Extract individual components
const [x, y, z] = transform.translation;
console.log(`Character is at (${x}, ${y}, ${z})`);
</code></pre>
<h2 id="related-functions-2"><a class="header" href="#related-functions-2">Related Functions</a></h2>
<ul>
<li><a href="sdk/entities/./findByName.html"><code>findByName()</code></a> - Find entities to get transforms for</li>
<li><a href="sdk/entities/../cameras/worldToGlobalViewport.html"><code>cameras.worldToGlobalViewport()</code></a> - Convert world positions to screen
coordinates</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cameras-api"><a class="header" href="#cameras-api">Cameras API</a></h1>
<p>The Cameras API provides utilities for coordinate system transformations and viewport management. This is essential for
positioning UI elements, placing effects, and converting between screen coordinates and 3D world positions.</p>
<h2 id="global-viewport"><a class="header" href="#global-viewport">Global Viewport</a></h2>
<p>The global viewport represents the entire screen space across all connected monitors.</p>
<h2 id="coordinate-systems"><a class="header" href="#coordinate-systems">Coordinate Systems</a></h2>
<p>Desktop Homunculus uses multiple coordinate systems:</p>
<ul>
<li><strong>Global Viewport</strong>: Screen-space coordinates relative to the entire desktop</li>
<li><strong>World 2D</strong>: 2D coordinates within the 3D world space</li>
<li><strong>World 3D</strong>: Full 3D coordinates in world space</li>
</ul>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<pre><code class="language-typescript">// Convert mouse position to world coordinates
const mousePos = {x: 150, y: 200};
const worldPos = await cameras.globalViewportToWorld2d(mousePos);

// Convert VRM position to screen coordinates  
const vrm = await Vrm.findByName('MyCharacter');
const vrmTransform = await entities.transform(vrm.entity);
const screenPos = await cameras.worldToGlobalViewport({
    x: vrmTransform.translation[0],
    y: vrmTransform.translation[1],
    z: vrmTransform.translation[2]
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="global-viewport-to-world-2d-conversion"><a class="header" href="#global-viewport-to-world-2d-conversion">Global Viewport to World 2D Conversion</a></h1>
<p>Converts global viewport coordinates to 2D world space coordinates.</p>
<p>This transformation maps screen-space coordinates (like mouse positions or UI element positions) into the 2D coordinate
system of the 3D world.
This is useful for placing objects or effects at screen positions within the 3D scene.</p>
<h2 id="parameters-4"><a class="header" href="#parameters-4">Parameters</a></h2>
<ul>
<li><code>viewport</code> (optional): Screen coordinates to convert
<ul>
<li><code>x</code>: X coordinate in screen space</li>
<li><code>y</code>: Y coordinate in screen space</li>
<li>If not provided, uses the center of the screen</li>
</ul>
</li>
</ul>
<h2 id="returns-3"><a class="header" href="#returns-3">Returns</a></h2>
<p>Promise that resolves to a <code>World2d</code> object with <code>x</code> and <code>y</code> coordinates in world space.</p>
<h2 id="examples-3"><a class="header" href="#examples-3">Examples</a></h2>
<h3 id="convert-mouse-click-to-world-position"><a class="header" href="#convert-mouse-click-to-world-position">Convert Mouse Click to World Position</a></h3>
<pre><code class="language-typescript">// Convert mouse click to world position
document.addEventListener('click', async (event) =&gt; {
    const worldPos = await cameras.globalViewportToWorld2d({
        x: event.clientX,
        y: event.clientY
    });

    console.log(`Clicked at world position:`, worldPos);

    // Spawn an effect at the clicked position
    await effects.stamp('click-indicator/marker.png', {
        position: [worldPos.x, worldPos.y]
    });
});
</code></pre>
<h2 id="related-functions-3"><a class="header" href="#related-functions-3">Related Functions</a></h2>
<ul>
<li><a href="sdk/cameras/./worldToGlobalViewport.html"><code>worldToGlobalViewport()</code></a> - Convert 3D world coordinates to screen coordinates</li>
<li><a href="sdk/cameras/../entities/setTransform.html"><code>entities.setTransform()</code></a> - Set entity position using world coordinates</li>
<li><a href="sdk/cameras/../effects/stamp.html"><code>effects.stamp()</code></a> - Display effects at world positions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="world-to-global-viewport"><a class="header" href="#world-to-global-viewport">World to Global Viewport</a></h1>
<p>Converts 3D world coordinates to global viewport (screen) coordinates.</p>
<p>This transformation projects 3D positions in the world onto screen space, allowing you to position UI elements, effects,
or webviews relative to 3D objects like VRM characters or scene elements.</p>
<h2 id="parameters-5"><a class="header" href="#parameters-5">Parameters</a></h2>
<ul>
<li><code>world</code> (optional): 3D world coordinates to convert
<ul>
<li><code>x</code>: X coordinate in world space</li>
<li><code>y</code>: Y coordinate in world space</li>
<li><code>z</code>: Z coordinate in world space</li>
<li>If not provided, uses the world origin (0, 0, 0)</li>
</ul>
</li>
</ul>
<h2 id="returns-4"><a class="header" href="#returns-4">Returns</a></h2>
<p>Promise that resolves to a <code>GlobalViewport</code> object with <code>x</code> and <code>y</code> screen coordinates.</p>
<h2 id="examples-4"><a class="header" href="#examples-4">Examples</a></h2>
<h3 id="position-ui-above-vrm-character"><a class="header" href="#position-ui-above-vrm-character">Position UI Above VRM Character</a></h3>
<pre><code class="language-typescript">// Position UI above a VRM character
const vrm = await Vrm.findByName('MyCharacter');
const vrmTransform = await entities.transform(vrm.entity);

const screenPos = await cameras.worldToGlobalViewport({
    x: vrmTransform.translation[0],
    y: vrmTransform.translation[1] + 1.8, // Above character's head
    z: vrmTransform.translation[2]
});

await Webview.open('character-info', {
    position: [screenPos.x - 100, screenPos.y - 50], // Center the 200px wide webview
    resolution: [200, 100],
    transparent: true
});
</code></pre>
<h2 id="related-functions-4"><a class="header" href="#related-functions-4">Related Functions</a></h2>
<ul>
<li><a href="sdk/cameras/./globalViewportToWorld2d.html"><code>globalViewportToWorld2d()</code></a> - Convert screen coordinates to 2D world coordinates</li>
<li><a href="sdk/cameras/../entities/transform.html"><code>entities.transform()</code></a> - Get entity position in world space</li>
<li><a href="sdk/cameras/../webviews/open.html"><code>webviews.open()</code></a> - Create positioned webviews</li>
<li><a href="sdk/cameras/../effects/stamp.html"><code>effects.stamp()</code></a> - Display effects at screen positions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrm-character-management"><a class="header" href="#vrm-character-management">VRM Character Management</a></h1>
<p>The VRM Character Management system provides comprehensive control over 3D virtual characters in Desktop Homunculus.
VRM (Virtual Reality Model) is a 3D avatar file format that enables rich character interactions, animations, and
immersive experiences.</p>
<h2 id="overview-4"><a class="header" href="#overview-4">Overview</a></h2>
<p>VRM characters are the core interactive elements of Desktop Homunculus. They can be spawned, controlled, animated, and
serve as the foundation for AI-powered conversations and interactions. The VRM system supports:</p>
<ul>
<li><strong>Character Spawning</strong>: Load VRM models from mod assets</li>
<li><strong>Animation Control</strong>: Play VRMA animations and manage character states</li>
<li><strong>Real-Time Events</strong>: Respond to mouse interactions, drag events, and state changes</li>
<li><strong>AI Integration</strong>: Text-to-speech capabilities with VoiceVox</li>
<li><strong>Look-At System</strong>: Configure characters to look at cursor or specific targets</li>
<li><strong>Bone Manipulation</strong>: Access individual bones for precise control</li>
<li><strong>Multi-Character Support</strong>: Manage multiple VRM instances simultaneously</li>
</ul>
<h2 id="core-concepts"><a class="header" href="#core-concepts">Core Concepts</a></h2>
<h3 id="character-states"><a class="header" href="#character-states">Character States</a></h3>
<p>VRM characters have the following built-in states:</p>
<ul>
<li><strong><code>idle</code></strong> - Default resting state (automatically assigned on spawn)</li>
<li><strong><code>sitting</code></strong> - Character is in a sitting position</li>
<li><strong><code>drag</code></strong> - Character is being dragged by the user (automatically set during drag operations)</li>
<li><strong>Custom states</strong> - You can define any string as a custom state for mod-specific behaviors</li>
</ul>
<h3 id="event-system"><a class="header" href="#event-system">Event System</a></h3>
<p>Characters emit events for various interactions:</p>
<ul>
<li><strong>Pointer Events</strong>: Click, press, release, hover</li>
<li><strong>Drag Events</strong>: Drag start, drag, drag end</li>
<li><strong>State Events</strong>: State change notifications</li>
</ul>
<h3 id="bones"><a class="header" href="#bones">Bones</a></h3>
<p>VRM characters have a standardized bone structure:</p>
<ul>
<li><strong>Core Bones</strong>: hips, spine, chest, neck, head</li>
<li><strong>Arms</strong>: leftShoulder, leftArm, leftForeArm, leftHand (and right variants)</li>
<li><strong>Legs</strong>: leftUpLeg, leftLeg, leftFoot (and right variants)</li>
</ul>
<h2 id="related-documentation"><a class="header" href="#related-documentation">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/../vrma/index.html">VRMA Animation System</a></strong> - Animation control and playback</li>
<li><strong><a href="sdk/vrm/../gpt/index.html">GPT Integration</a></strong> - AI-powered conversations</li>
<li><strong><a href="sdk/vrm/../entities/index.html">Entity Management</a></strong> - Transform and positioning control</li>
<li><strong><a href="sdk/vrm/../preferences/index.html">Preferences</a></strong> - Character state persistence</li>
<li><strong><a href="sdk/vrm/../effects/index.html">Effects System</a></strong> - Visual and audio effects</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmspawn"><a class="header" href="#vrmspawn">Vrm.spawn()</a></h1>
<p>Creates and spawns a new VRM character instance from a mod asset, making it visible and interactive in the application.</p>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

// Spawn a character with default settings
const character = await Vrm.spawn('characters/assistant.vrm');
console.log('Character spawned successfully');

// Character is ready for interaction
const name = await character.name();
console.log(`Spawned character: ${name}`);
</code></pre>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

// Spawn character at a specific position
const character = await Vrm.spawn('characters/guide.vrm', {
    transform: {
        translation: [2.0, 0.0, 1.0],  // Move to position (2, 0, 1)
        scale: [1.2, 1.2, 1.2]         // Make 20% larger
    }
});

console.log('Character spawned at custom position');
</code></pre>
<h2 id="parameters-6"><a class="header" href="#parameters-6">Parameters</a></h2>
<ul>
<li><code>asset</code> (string) - The mod asset path of the VRM model relative to <code>assets/mods/</code>.</li>
<li><code>options</code> (SpawnVrmOptions, optional) - Configuration options for spawning</li>
</ul>
<h3 id="spawnvrmoptions"><a class="header" href="#spawnvrmoptions">SpawnVrmOptions</a></h3>
<pre><code class="language-typescript">interface SpawnVrmOptions {
    transform?: Partial&lt;Transform&gt;;  // Initial position, rotation, and scale
}
</code></pre>
<h3 id="transform-1"><a class="header" href="#transform-1">Transform</a></h3>
<pre><code class="language-typescript">interface Transform {
    translation: [number, number, number];  // Position [x, y, z]
    rotation: [number, number, number, number];  // Quaternion [x, y, z, w]
    scale: [number, number, number];  // Scale [x, y, z]
}
</code></pre>
<h2 id="returns-5"><a class="header" href="#returns-5">Returns</a></h2>
<p><code>Promise&lt;Vrm&gt;</code> - A new VRM character instance that can be controlled and interacted with</p>
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>The <code>spawn()</code> static method creates a new VRM character from a model asset and places it in the application environment.
The character starts in the <code>idle</code> state and is immediately available for interaction. This is the primary method for
creating character instances in mods.</p>
<h2 id="common-use-cases-1"><a class="header" href="#common-use-cases-1">Common Use Cases</a></h2>
<h3 id="character-creation"><a class="header" href="#character-creation">Character Creation</a></h3>
<p>Spawn main characters, NPCs, and interactive avatars for applications.</p>
<h3 id="scene-population"><a class="header" href="#scene-population">Scene Population</a></h3>
<p>Create multiple characters to populate environments and scenes.</p>
<h3 id="user-avatars"><a class="header" href="#user-avatars">User Avatars</a></h3>
<p>Allow users to select and spawn their preferred character representations.</p>
<h3 id="dynamic-content"><a class="header" href="#dynamic-content">Dynamic Content</a></h3>
<p>Spawn characters based on user actions, story progression, or application state.</p>
<h3 id="multi-character-experiences"><a class="header" href="#multi-character-experiences">Multi-Character Experiences</a></h3>
<p>Create group interactions, conversations, and collaborative scenarios.</p>
<h2 id="related-documentation-1"><a class="header" href="#related-documentation-1">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
<li><strong><a href="sdk/vrm/findByName.html">Vrm.findByName()</a></strong> - Finding spawned characters</li>
<li><strong><a href="sdk/vrm/./findAll.html">Vrm.findAll()</a></strong> - Getting all spawned characters</li>
<li><strong><a href="sdk/vrm/../math/index.html">Transform System</a></strong> - Position, rotation, and scale management</li>
<li><strong><a href="sdk/vrm/../mods/index.html">Mod Asset System</a></strong> - Managing VRM model assets</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmfindbyname"><a class="header" href="#vrmfindbyname">Vrm.findByName()</a></h1>
<p>Finds and returns an existing VRM character instance by its name. This method allows you to access characters that have
already been spawned by other parts of the application or by different mods.</p>
<h2 id="parameters-7"><a class="header" href="#parameters-7">Parameters</a></h2>
<ul>
<li><code>vrmName</code> (string) - The name of the VRM character to find</li>
</ul>
<h2 id="returns-6"><a class="header" href="#returns-6">Returns</a></h2>
<p><code>Promise&lt;Vrm&gt;</code> - The VRM character instance with the specified name</p>
<h2 id="description-1"><a class="header" href="#description-1">Description</a></h2>
<p>The <code>findByName()</code> static method searches for an already-spawned VRM character by its name and returns a reference to
that character. This is useful for accessing characters created by other mods or parts of the application, enabling
cross-mod character interactions and shared character management.</p>
<h2 id="character-names"><a class="header" href="#character-names">Character Names</a></h2>
<p>Character names are typically derived from:</p>
<ul>
<li>The VRM model's metadata</li>
<li>The asset filename (without extension)</li>
<li>Custom naming during spawn operations</li>
</ul>
<h2 id="examples-5"><a class="header" href="#examples-5">Examples</a></h2>
<h3 id="basic-character-finding"><a class="header" href="#basic-character-finding">Basic Character Finding</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

// Find a character by name
try {
    const alice = await Vrm.findByName('Alice');
    console.log('Found character:', await alice.name());

    // Interact with the found character
    await alice.setState('greeting');
    await alice.speakOnVoiceVox('Hello! Someone found me!');
} catch (error) {
    console.error('Character not found:', error);
}
</code></pre>
<h2 id="common-use-cases-2"><a class="header" href="#common-use-cases-2">Common Use Cases</a></h2>
<h3 id="mod-coordination"><a class="header" href="#mod-coordination">Mod Coordination</a></h3>
<p>Find characters created by other mods for cross-mod interactions.</p>
<h3 id="character-discovery"><a class="header" href="#character-discovery">Character Discovery</a></h3>
<p>Discover and interact with characters that may appear dynamically.</p>
<h3 id="system-integration"><a class="header" href="#system-integration">System Integration</a></h3>
<p>Access system-managed characters from custom mod code.</p>
<h3 id="multi-mod-communication"><a class="header" href="#multi-mod-communication">Multi-Mod Communication</a></h3>
<p>Enable communication between characters managed by different mods.</p>
<h3 id="character-verification"><a class="header" href="#character-verification">Character Verification</a></h3>
<p>Verify character availability before performing operations.</p>
<h2 id="related-documentation-2"><a class="header" href="#related-documentation-2">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/spawn.html">Vrm.spawn()</a></strong> - Creating new characters</li>
<li><strong><a href="sdk/vrm/./findAll.html">Vrm.findAll()</a></strong> - Getting all characters</li>
<li><strong><a href="sdk/vrm/./waitLoadByName.html">Vrm.waitLoadByName()</a></strong> - Waiting for character loading</li>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
<li><strong><a href="sdk/vrm/name.html">Vrm.name()</a></strong> - Getting character names</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmfindboneentity"><a class="header" href="#vrmfindboneentity">Vrm.findBoneEntity()</a></h1>
<p>Finds the entity ID of a specific bone within the VRM character's skeleton. This allows for precise manipulation of
individual bones for advanced character control and positioning.</p>
<h2 id="parameters-8"><a class="header" href="#parameters-8">Parameters</a></h2>
<ul>
<li><code>bone</code> (Bones) - The name of the bone to find</li>
</ul>
<h2 id="returns-7"><a class="header" href="#returns-7">Returns</a></h2>
<p><code>Promise&lt;number&gt;</code> - The entity ID of the specified bone</p>
<h2 id="available-bones"><a class="header" href="#available-bones">Available Bones</a></h2>
<p>The VRM standard defines the following bone names:</p>
<h3 id="core-bones"><a class="header" href="#core-bones">Core Bones</a></h3>
<ul>
<li><strong><code>hips</code></strong> - Root bone of the skeleton</li>
<li><strong><code>spine</code></strong> - Lower spine</li>
<li><strong><code>chest</code></strong> - Upper chest/torso</li>
<li><strong><code>neck</code></strong> - Neck connection</li>
<li><strong><code>head</code></strong> - Head bone</li>
</ul>
<h3 id="arm-bones"><a class="header" href="#arm-bones">Arm Bones</a></h3>
<ul>
<li><strong><code>leftShoulder</code></strong> / <strong><code>rightShoulder</code></strong> - Shoulder joints</li>
<li><strong><code>leftArm</code></strong> / <strong><code>rightArm</code></strong> - Upper arm bones</li>
<li><strong><code>leftForeArm</code></strong> / <strong><code>rightForeArm</code></strong> - Lower arm bones</li>
<li><strong><code>leftHand</code></strong> / <strong><code>rightHand</code></strong> - Hand bones</li>
</ul>
<h3 id="leg-bones"><a class="header" href="#leg-bones">Leg Bones</a></h3>
<ul>
<li><strong><code>leftUpLeg</code></strong> / <strong><code>rightUpLeg</code></strong> - Upper leg bones (thighs)</li>
<li><strong><code>leftLeg</code></strong> / <strong><code>rightLeg</code></strong> - Lower leg bones (shins)</li>
<li><strong><code>leftFoot</code></strong> / <strong><code>rightFoot</code></strong> - Foot bones</li>
</ul>
<h2 id="examples-6"><a class="header" href="#examples-6">Examples</a></h2>
<h3 id="basic-bone-access"><a class="header" href="#basic-bone-access">Basic Bone Access</a></h3>
<pre><code class="language-typescript">import {Vrm, entities} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::humanoid.vrm');

// Get head bone entity
const headEntity = await character.findBoneEntity('head');
const boneTransform = await entities.transform(headEntity);
console.log(`Head bone entity ID: ${headEntity}, transform: ${JSON.stringify(boneTransform)}`);

// Get hand bone entities
const leftHandEntity = await character.findBoneEntity('leftHand');
const rightHandEntity = await character.findBoneEntity('rightHand');

console.log(`Left hand: ${leftHandEntity}, Right hand: ${rightHandEntity}`);

</code></pre>
<h2 id="common-use-cases-3"><a class="header" href="#common-use-cases-3">Common Use Cases</a></h2>
<h3 id="facial-animation"><a class="header" href="#facial-animation">Facial Animation</a></h3>
<p>Manipulate head and neck bones for looking behaviors and expressions.</p>
<h3 id="gesture-control"><a class="header" href="#gesture-control">Gesture Control</a></h3>
<p>Control arm and hand bones for pointing, waving, and other gestures.</p>
<h3 id="interactive-elements"><a class="header" href="#interactive-elements">Interactive Elements</a></h3>
<p>Attach UI elements or effects to specific bones that move with the character.</p>
<h3 id="physics-simulation"><a class="header" href="#physics-simulation">Physics Simulation</a></h3>
<p>Apply constraints and forces to bones for realistic movement.</p>
<h3 id="accessibility-features"><a class="header" href="#accessibility-features">Accessibility Features</a></h3>
<p>Highlight or manipulate specific bones for educational or debugging purposes.</p>
<h2 id="related-documentation-3"><a class="header" href="#related-documentation-3">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/../entities/index.html">Entity Management</a></strong> - Transform manipulation for bones</li>
<li><strong><a href="sdk/vrm/../cameras/index.html">Cameras</a></strong> - Converting between coordinate systems</li>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
<li><strong><a href="sdk/vrm/../vrma/index.html">VRMA Animation System</a></strong> - Animation integration with bone control</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmevents"><a class="header" href="#vrmevents">Vrm.events()</a></h1>
<p>Returns an EventSource for receiving real-time events related to this VRM character.
This method provides access to user interactions, state changes, and other character-specific events.</p>
<h2 id="parameters-9"><a class="header" href="#parameters-9">Parameters</a></h2>
<p>None.</p>
<h2 id="returns-8"><a class="header" href="#returns-8">Returns</a></h2>
<p><code>VrmEventSource</code> - An event source object for listening to VRM character events</p>
<h2 id="description-2"><a class="header" href="#description-2">Description</a></h2>
<p>The <code>events()</code> method creates a Server-Sent Events (SSE) connection that streams real-time events from the VRM
character. This enables reactive programming patterns where your mod can respond immediately to user interactions and
character state changes.</p>
<h2 id="available-events"><a class="header" href="#available-events">Available Events</a></h2>
<p>The VrmEventSource provides access to the following event types:</p>
<h3 id="pointer-events"><a class="header" href="#pointer-events">Pointer Events</a></h3>
<ul>
<li><strong><code>pointer-click</code></strong> - Mouse click on the character</li>
<li><strong><code>pointer-press</code></strong> - Mouse button pressed down</li>
<li><strong><code>pointer-release</code></strong> - Mouse button released</li>
<li><strong><code>pointer-over</code></strong> - Mouse cursor enters character area</li>
<li><strong><code>pointer-out</code></strong> - Mouse cursor leaves character area</li>
<li><strong><code>pointer-cancel</code></strong> - Pointer event cancelled</li>
</ul>
<h3 id="drag-events"><a class="header" href="#drag-events">Drag Events</a></h3>
<ul>
<li><strong><code>drag-start</code></strong> - User starts dragging the character</li>
<li><strong><code>drag</code></strong> - Character is being dragged (continuous)</li>
<li><strong><code>drag-end</code></strong> - User stops dragging the character</li>
</ul>
<h3 id="state-events"><a class="header" href="#state-events">State Events</a></h3>
<ul>
<li><strong><code>state-change</code></strong> - Character state has changed</li>
</ul>
<h2 id="event-data-structures"><a class="header" href="#event-data-structures">Event Data Structures</a></h2>
<h3 id="vrmpointerevent"><a class="header" href="#vrmpointerevent">VrmPointerEvent</a></h3>
<pre><code class="language-typescript">interface VrmPointerEvent {
    globalViewport: [number, number]; // Cursor position in global viewport
}
</code></pre>
<h3 id="vrmdragevent"><a class="header" href="#vrmdragevent">VrmDragEvent</a></h3>
<pre><code class="language-typescript">interface VrmDragEvent extends VrmPointerEvent {
    delta: [number, number]; // Change in cursor position since last event
}
</code></pre>
<h3 id="vrmmouseevent"><a class="header" href="#vrmmouseevent">VrmMouseEvent</a></h3>
<pre><code class="language-typescript">interface VrmMouseEvent extends VrmPointerEvent {
    button: "Primary" | "Secondary" | "Middle"; // Which mouse button
}
</code></pre>
<h3 id="vrmstatechangeevent"><a class="header" href="#vrmstatechangeevent">VrmStateChangeEvent</a></h3>
<pre><code class="language-typescript">interface VrmStateChangeEvent {
    state: string; // The new state of the VRM
}
</code></pre>
<h2 id="examples-7"><a class="header" href="#examples-7">Examples</a></h2>
<h3 id="basic-event-handling"><a class="header" href="#basic-event-handling">Basic Event Handling</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::interactive.vrm');
const events = character.events();

// Handle click events
events.on('pointer-click', (event) =&gt; {
    console.log('Character clicked at:', event.globalViewport);
    console.log('Button:', event.button);
});

// Handle state changes
events.on('state-change', (event) =&gt; {
    console.log('Character state changed to:', event.state);
});

// Clean up when done
// events.close();
</code></pre>
<h2 id="common-use-cases-4"><a class="header" href="#common-use-cases-4">Common Use Cases</a></h2>
<h3 id="interactive-ui-creation"><a class="header" href="#interactive-ui-creation">Interactive UI Creation</a></h3>
<p>Create responsive interfaces that react to character interactions in real-time.</p>
<h3 id="animation-triggering"><a class="header" href="#animation-triggering">Animation Triggering</a></h3>
<p>Use events to trigger appropriate animations based on user actions and character states.</p>
<h3 id="state-management"><a class="header" href="#state-management">State Management</a></h3>
<p>Monitor and respond to character state changes for complex behavior systems.</p>
<h3 id="multi-character-coordination"><a class="header" href="#multi-character-coordination">Multi-Character Coordination</a></h3>
<p>Coordinate behaviors between multiple characters based on individual character events.</p>
<h3 id="user-feedback-systems"><a class="header" href="#user-feedback-systems">User Feedback Systems</a></h3>
<p>Provide immediate visual and audio feedback for user interactions.</p>
<h2 id="related-documentation-4"><a class="header" href="#related-documentation-4">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/../VrmEventSource/index.html">VrmEventSource</a></strong> - Event source class details</li>
<li><strong><a href="sdk/vrm/../VrmEventSource/on.html">VrmEventSource.on()</a></strong> - Event listener registration</li>
<li><strong><a href="sdk/vrm/../VrmEventSource/close.html">VrmEventSource.close()</a></strong> - Cleanup and resource management</li>
<li><strong><a href="sdk/vrm/setState.html">Vrm.setState()</a></strong> - Character state management</li>
<li><strong><a href="sdk/vrm/../vrma/index.html">VRMA Animation System</a></strong> - Animation control integration</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmstate"><a class="header" href="#vrmstate">Vrm.state()</a></h1>
<p>Returns the current state of the VRM character. Character states control behavior patterns and can be used to coordinate
animations, interactions, and other character-specific logic.</p>
<h2 id="parameters-10"><a class="header" href="#parameters-10">Parameters</a></h2>
<p>None.</p>
<h2 id="returns-9"><a class="header" href="#returns-9">Returns</a></h2>
<p><code>Promise&lt;string&gt;</code> - The current state of the VRM character</p>
<h2 id="description-3"><a class="header" href="#description-3">Description</a></h2>
<p>The <code>state()</code> method retrieves the current behavioral state of a VRM character. States are string identifiers that
represent the character's current condition or activity. The system has built-in states for common behaviors, and you
can also define custom states for mod-specific functionality.</p>
<h2 id="built-in-states"><a class="header" href="#built-in-states">Built-in States</a></h2>
<h3 id="default-states"><a class="header" href="#default-states">Default States</a></h3>
<ul>
<li><strong><code>idle</code></strong> - Default resting state (assigned automatically on spawn)</li>
<li><strong><code>sitting</code></strong> - Character is in a sitting position</li>
<li><strong><code>drag</code></strong> - Character is being dragged by the user (automatically set/unset)</li>
</ul>
<h3 id="custom-states"><a class="header" href="#custom-states">Custom States</a></h3>
<p>Any string can be used as a custom state for mod-specific behaviors:</p>
<ul>
<li><code>greeting</code>, <code>talking</code>, <code>thinking</code>, <code>celebrating</code>, <code>sleeping</code>, etc.</li>
</ul>
<h2 id="examples-8"><a class="header" href="#examples-8">Examples</a></h2>
<h3 id="basic-state-checking"><a class="header" href="#basic-state-checking">Basic State Checking</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::assistant.vrm');

// Check current state
const currentState = await character.state();
console.log(`Character is currently: ${currentState}`); // "idle"

// State-based logic
if (currentState === 'idle') {
    console.log('Character is available for interaction');
} else if (currentState === 'drag') {
    console.log('Character is being moved');
} else {
    console.log(`Character is in custom state: ${currentState}`);
}

// Set a custom state
await character.setState('greeting');
</code></pre>
<h2 id="common-use-cases-5"><a class="header" href="#common-use-cases-5">Common Use Cases</a></h2>
<h3 id="conditional-logic"><a class="header" href="#conditional-logic">Conditional Logic</a></h3>
<p>Use current state to determine appropriate actions and responses.</p>
<h3 id="animation-coordination"><a class="header" href="#animation-coordination">Animation Coordination</a></h3>
<p>Check state before triggering animations to avoid conflicts.</p>
<h3 id="ui-updates"><a class="header" href="#ui-updates">UI Updates</a></h3>
<p>Update interface elements based on character state changes.</p>
<h3 id="behavior-trees"><a class="header" href="#behavior-trees">Behavior Trees</a></h3>
<p>Implement complex AI behaviors that depend on character states.</p>
<h3 id="state-persistence"><a class="header" href="#state-persistence">State Persistence</a></h3>
<p>Save and restore character states across application sessions.</p>
<h2 id="related-documentation-5"><a class="header" href="#related-documentation-5">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/setState.html">Vrm.setState()</a></strong> - Changing character states</li>
<li><strong><a href="sdk/vrm/events.html">Vrm.events()</a></strong> - Monitoring state changes via events</li>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
<li><strong><a href="sdk/vrm/../preferences/index.html">Preferences</a></strong> - Persisting state information</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmspeakonvoicevox"><a class="header" href="#vrmspeakonvoicevox">Vrm.speakOnVoiceVox()</a></h1>
<p>Converts text to speech using the VoiceVox text-to-speech engine and makes the VRM character speak the provided text
with optional voice customization and subtitle display.</p>
<p>To use this method, <a href="https://voicevox.hiroshiba.jp/"><code>VoiceVox</code></a> must be running beforehand.
If <code>VoiceVox</code> is not running, the method will silently fail without throwing an error.</p>
<h2 id="parameters-11"><a class="header" href="#parameters-11">Parameters</a></h2>
<ul>
<li><code>text</code>(string) - The text content to convert to speech</li>
<li><code>options</code>(SpeakOnVoiceVoxOptions, optional) - Configuration options for voice and subtitles</li>
</ul>
<h3 id="speakonvoicevoxoptions"><a class="header" href="#speakonvoicevoxoptions">SpeakOnVoiceVoxOptions</a></h3>
<pre><code class="language-typescript">interface SpeakOnVoiceVoxOptions {
    speaker?: number; // VoiceVox speaker ID (voice selection)
    subtitle?: SubtitleOptions; // Subtitle display configuration
}

</code></pre>
<h3 id="subtitleoptions"><a class="header" href="#subtitleoptions">SubtitleOptions</a></h3>
<p>If this option is specified, subtitles will be displayed at the bottom of the screen.</p>
<pre><code class="language-typescript">interface SubtitleOptions {
    font?: string;                              // Mod asset ID for subtitle font
    fontSize?: number;                          // Font size for subtitles
    color?: [number, number, number, number];   // RGBA color values (0-1 range)
}
</code></pre>
<h2 id="returns-10"><a class="header" href="#returns-10">Returns</a></h2>
<p><code>Promise&lt;ReadableStream&lt;string&gt;&gt;</code> - A readable stream of the speech synthesis response</p>
<h2 id="description-4"><a class="header" href="#description-4">Description</a></h2>
<p>The <code>speakOnVoiceVox()</code> method uses the VoiceVox text-to-speech engine to generate realistic speech audio for the
character. VoiceVox must be running as a separate service for this method to function. If VoiceVox is not available, the
method will silently fail without throwing an error.</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<ul>
<li><strong>VoiceVox Server</strong>: Must be running and accessible</li>
<li><strong>No error on failure</strong>: If VoiceVox is unavailable, the method succeeds but no speech occurs</li>
</ul>
<h2 id="examples-9"><a class="header" href="#examples-9">Examples</a></h2>
<h3 id="basic-text-to-speech"><a class="header" href="#basic-text-to-speech">Basic Text-to-Speech</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::speaker.vrm');

// Simple speech
await character.speakOnVoiceVox('Hello! Nice to meet you.');

// Longer speech
await character.speakOnVoiceVox(
    'Welcome to our application. I am your virtual assistant, ready to help you with any questions or tasks you might have.'
);
</code></pre>
<h2 id="common-use-cases-6"><a class="header" href="#common-use-cases-6">Common Use Cases</a></h2>
<h3 id="character-dialogue"><a class="header" href="#character-dialogue">Character Dialogue</a></h3>
<p>Make characters speak conversational text with appropriate voice selection.</p>
<h3 id="system-announcements"><a class="header" href="#system-announcements">System Announcements</a></h3>
<p>Use text-to-speech for important notifications and system messages.</p>
<h3 id="educational-content"><a class="header" href="#educational-content">Educational Content</a></h3>
<p>Provide spoken explanations and tutorials with subtitle support.</p>
<h3 id="interactive-storytelling"><a class="header" href="#interactive-storytelling">Interactive Storytelling</a></h3>
<p>Create immersive narrative experiences with multiple voices and characters.</p>
<h3 id="accessibility-features-1"><a class="header" href="#accessibility-features-1">Accessibility Features</a></h3>
<p>Convert text content to audio for users with visual impairments.</p>
<h2 id="related-documentation-6"><a class="header" href="#related-documentation-6">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
<li><strong><a href="sdk/vrm/setState.html">Vrm.setState()</a></strong> - Coordinating speech with character states</li>
<li><strong><a href="sdk/vrm/../../webview/index.html">Webview System</a></strong> - Creating custom subtitle interfaces</li>
<li><strong><a href="sdk/vrm/../mods/index.html">Mod Asset System</a></strong> - Managing font and audio assets</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmvrma"><a class="header" href="#vrmvrma">Vrm.vrma()</a></h1>
<p>Fetch or load a VRMA animation instance for the VRM character.
If the VRMA animation doesn't exist, it spawns a new one and returns it.</p>
<h2 id="parameters-12"><a class="header" href="#parameters-12">Parameters</a></h2>
<ul>
<li><code>source</code> (string) - The VRMA animation path relative to <code>assets/mods</code> directory.</li>
</ul>
<h2 id="returns-11"><a class="header" href="#returns-11">Returns</a></h2>
<p><code>Promise&lt;Vrma&gt;</code> - A VRMA animation instance that can be controlled for playback</p>
<h2 id="examples-10"><a class="header" href="#examples-10">Examples</a></h2>
<h3 id="basic-animation-loading"><a class="header" href="#basic-animation-loading">Basic Animation Loading</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters/dancer.vrm');

// Load and play a wave animation
const waveAnimation = await character.vrma('animations/wave-hello.vrma');
await waveAnimation.play({
    repeat: Repeat.count(3),
    transitionSecs: 0.5
});

console.log('Wave animation completed');
</code></pre>
<h2 id="common-use-cases-7"><a class="header" href="#common-use-cases-7">Common Use Cases</a></h2>
<h3 id="character-state-animations"><a class="header" href="#character-state-animations">Character State Animations</a></h3>
<p>Load different animations for different character behavioral states.</p>
<h3 id="interactive-responses"><a class="header" href="#interactive-responses">Interactive Responses</a></h3>
<p>Load reaction animations that play in response to user interactions.</p>
<h3 id="cutscenes-and-sequences"><a class="header" href="#cutscenes-and-sequences">Cutscenes and Sequences</a></h3>
<p>Load and coordinate multiple animations for storytelling sequences.</p>
<h3 id="procedural-animation"><a class="header" href="#procedural-animation">Procedural Animation</a></h3>
<p>Combine VRMA animations with bone manipulation for complex behaviors.</p>
<h3 id="user-generated-content"><a class="header" href="#user-generated-content">User-Generated Content</a></h3>
<p>Allow users to add their own animation assets to characters.</p>
<h2 id="related-documentation-7"><a class="header" href="#related-documentation-7">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrm/../vrma/index.html">VRMA Animation System</a></strong> - Animation playback and control</li>
<li><strong><a href="sdk/vrm/../vrma/play.html">Vrma.play()</a></strong> - Playing loaded animations</li>
<li><strong><a href="sdk/vrm/../vrma/stop.html">Vrma.stop()</a></strong> - Stopping animations</li>
<li><strong><a href="sdk/vrm/../vrma/Repeat.html">Repeat Class</a></strong> - Animation repeat configuration</li>
<li><strong><a href="sdk/vrm/index.html">VRM Character Management</a></strong> - Overall character system</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrm-animation-system"><a class="header" href="#vrm-animation-system">VRM Animation System</a></h1>
<p>The VRMA (VRM Animation) system provides sophisticated animation control for VRM characters in Desktop Homunculus. VRMA
files contain pre-recorded animations that can be applied to VRM models, enabling rich character expressions, movements,
and behaviors.</p>
<h2 id="overview-5"><a class="header" href="#overview-5">Overview</a></h2>
<p>VRMA animations are motion capture or hand-crafted animation sequences stored in the VRMA format. The animation system
supports:</p>
<ul>
<li><strong>Animation Playback</strong>: Play, pause, and stop VRMA animations</li>
<li><strong>Repeat Control</strong>: Configure looping and repetition patterns</li>
<li><strong>Smooth Transitions</strong>: Blend between animations with customizable timing</li>
<li><strong>Asset Integration</strong>: Load animations from mod assets</li>
<li><strong>Multi-Character Support</strong>: Apply different animations to multiple VRM instances</li>
</ul>
<h2 id="core-concepts-1"><a class="header" href="#core-concepts-1">Core Concepts</a></h2>
<h3 id="repeat-patterns"><a class="header" href="#repeat-patterns">Repeat Patterns</a></h3>
<p>VRMA animations support various repeat behaviors:</p>
<ul>
<li><strong>Never</strong>: Play once and stop</li>
<li><strong>Count</strong>: Repeat a specific number of times</li>
<li><strong>Forever</strong>: Loop continuously until manually stopped</li>
</ul>
<h3 id="smooth-transitions"><a class="header" href="#smooth-transitions">Smooth Transitions</a></h3>
<p>Animations can transition smoothly into each other with configurable durations to avoid jarring changes between
different movement patterns.</p>
<h2 id="api-reference"><a class="header" href="#api-reference">API Reference</a></h2>
<h3 id="vrma-class"><a class="header" href="#vrma-class">Vrma Class</a></h3>
<p>The main class for controlling individual VRMA animation instances.</p>
<h4 id="constructor"><a class="header" href="#constructor">Constructor</a></h4>
<p>Creates a VRMA instance wrapper around an animation entity ID.
Typically obtained through <a href="sdk/vrma/../vrm/vrma.html"><code>vrmInstance.vrma()</code></a> method rather than direct construction.</p>
<h4 id="methods"><a class="header" href="#methods">Methods</a></h4>
<ul>
<li><strong><a href="sdk/vrma/./play.html">play(args?)</a></strong> - Start animation playback with optional configuration</li>
<li><strong><a href="sdk/vrma/./stop.html">stop()</a></strong> - Stop animation playback immediately</li>
</ul>
<h3 id="repeat-class"><a class="header" href="#repeat-class">Repeat Class</a></h3>
<p>Utility class for configuring animation repeat behavior.</p>
<ul>
<li><strong><a href="sdk/vrma/./Repeat.html">Repeat</a></strong> - Repeat configuration class with static factory methods</li>
</ul>
<h2 id="usage-examples"><a class="header" href="#usage-examples">Usage Examples</a></h2>
<h3 id="basic-animation-playback"><a class="header" href="#basic-animation-playback">Basic Animation Playback</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

// Spawn a character
const character = await Vrm.spawn('animated-character::dancer.vrm');

// Get an animation instance
const waveAnimation = await character.vrma('animations::wave-hello.vrma');

// Play the animation once
await waveAnimation.play();

console.log('Wave animation completed');
</code></pre>
<h3 id="animation-with-repeat-control"><a class="header" href="#animation-with-repeat-control">Animation with Repeat Control</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::performer.vrm');

// Get dance animation
const danceAnimation = await character.vrma('animations::dance-loop.vrma');

// Play animation 5 times
await danceAnimation.play({
    repeat: Repeat.count(5)
});

// Play animation forever (until manually stopped)
const idleAnimation = await character.vrma('animations::idle-breathing.vrma');
await idleAnimation.play({
    repeat: Repeat.forever()
});

// Stop the looping animation after 10 seconds
setTimeout(async () =&gt; {
    await idleAnimation.stop();
}, 10000);
</code></pre>
<h3 id="smooth-animation-transitions"><a class="header" href="#smooth-animation-transitions">Smooth Animation Transitions</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::expressive.vrm');

// Start with idle animation
const idleAnim = await character.vrma('animations::idle.vrma');
await idleAnim.play({
    repeat: Repeat.forever()
});

// Transition to greeting with smooth blend
const greetingAnim = await character.vrma('animations::greeting.vrma');
await greetingAnim.play({
    transitionSecs: 0.5,  // 500ms smooth transition
    repeat: Repeat.count(1)
});

// Transition back to idle
await idleAnim.play({
    transitionSecs: 1.0,  // 1 second smooth transition
    repeat: Repeat.forever()
});
</code></pre>
<h2 id="related-documentation-8"><a class="header" href="#related-documentation-8">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrma/../vrm/index.html">VRM Character Management</a></strong> - Character spawning and control</li>
<li><strong><a href="sdk/vrma/../entities/index.html">Entity Management</a></strong> - Transform and positioning</li>
<li><strong><a href="sdk/vrma/../gpt/index.html">GPT Integration</a></strong> - AI-powered character behaviors</li>
<li><strong><a href="sdk/vrma/../effects/index.html">Effects System</a></strong> - Visual effects coordination</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmaplay"><a class="header" href="#vrmaplay">Vrma.play()</a></h1>
<p>Starts playback of a VRMA animation with optional configuration for repeat behavior and transition timing.</p>
<h2 id="parameters-13"><a class="header" href="#parameters-13">Parameters</a></h2>
<ul>
<li><code>args?</code> (PlayArgs) - Optional configuration object for animation playback</li>
</ul>
<h3 id="playargs-interface"><a class="header" href="#playargs-interface">PlayArgs Interface</a></h3>
<pre><code class="language-typescript">interface PlayArgs {
    repeat?: Repeat;          // Repeat configuration (default: play once)
    transitionSecs?: number;  // Transition duration in seconds (default: 0)
    waitFinished?: boolean; // Whether to wait for playback to finish before resolving (default: false)
}
</code></pre>
<h2 id="returns-12"><a class="header" href="#returns-12">Returns</a></h2>
<p><code>Promise&lt;void&gt;</code> - Resolves when the animation completes (or immediately for infinite loops)</p>
<h2 id="examples-11"><a class="header" href="#examples-11">Examples</a></h2>
<h3 id="basic-animation-playback-1"><a class="header" href="#basic-animation-playback-1">Basic Animation Playback</a></h3>
<pre><code class="language-typescript">import {Vrm} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::dancer.vrm');
const waveAnimation = await character.vrma('gestures::wave.vrma');

// Play animation once with default settings
await waveAnimation.play();

console.log('Wave animation completed');
</code></pre>
<h3 id="animation-with-repeat-control-1"><a class="header" href="#animation-with-repeat-control-1">Animation with Repeat Control</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::performer.vrm');

// Play animation multiple times
const applauseAnimation = await character.vrma('reactions::applause.vrma');
await applauseAnimation.play({
    repeat: Repeat.count(5)
});

// Play animation continuously
const idleAnimation = await character.vrma('ambient::idle-breathing.vrma');
await idleAnimation.play({
    repeat: Repeat.forever()
});

// Stop the looping animation after some time
setTimeout(async () =&gt; {
    await idleAnimation.stop();
}, 10000);
</code></pre>
<h3 id="smooth-animation-transitions-1"><a class="header" href="#smooth-animation-transitions-1">Smooth Animation Transitions</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::expressive.vrm');

// Start with idle animation
const idleAnim = await character.vrma('states::idle.vrma');
await idleAnim.play({
    repeat: Repeat.forever()
});

// Transition smoothly to new animation
const excitedAnim = await character.vrma('emotions::excited.vrma');
await excitedAnim.play({
    repeat: Repeat.count(3),
    transitionSecs: 0.8  // 800ms smooth transition
});

// Smooth transition back to idle
await idleAnim.play({
    repeat: Repeat.forever(),
    transitionSecs: 1.2,  // 1.2 second smooth transition
    waitFinished: true  // Wait for playback to finish before continuing
});
</code></pre>
<h2 id="related-documentation-9"><a class="header" href="#related-documentation-9">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrma/./index.html">VRMA Animation System</a></strong> - Main VRMA documentation</li>
<li><strong><a href="sdk/vrma/./Repeat.html">Repeat Class</a></strong> - Animation repeat configuration</li>
<li><strong><a href="sdk/vrma/./stop.html">Vrma.stop()</a></strong> - Stopping animation playback</li>
<li><strong><a href="sdk/vrma/../vrm/index.html">VRM Character Management</a></strong> - Character control and states</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrmastop"><a class="header" href="#vrmastop">Vrma.stop()</a></h1>
<p>Immediately stops the playback of a VRMA animation, interrupting any ongoing playback or looping.</p>
<h2 id="syntax"><a class="header" href="#syntax">Syntax</a></h2>
<pre><code class="language-typescript">await vrma.stop()
</code></pre>
<h2 id="parameters-14"><a class="header" href="#parameters-14">Parameters</a></h2>
<p>None.</p>
<h2 id="returns-13"><a class="header" href="#returns-13">Returns</a></h2>
<p><code>Promise&lt;void&gt;</code> - Resolves when the animation has been stopped</p>
<h2 id="examples-12"><a class="header" href="#examples-12">Examples</a></h2>
<h3 id="basic-animation-stopping"><a class="header" href="#basic-animation-stopping">Basic Animation Stopping</a></h3>
<pre><code class="language-typescript">import {Vrm, Repeat} from '@homunculus/sdk';

const character = await Vrm.spawn('characters::dancer.vrm');

// Start a looping idle animation
const idleAnimation = await character.vrma('ambient::idle-breathing.vrma');
await idleAnimation.play({
    repeat: Repeat.forever()
});

// Stop the animation after 5 seconds
setTimeout(async () =&gt; {
    await idleAnimation.stop();
    console.log('Idle animation stopped');
}, 5000);
</code></pre>
<h2 id="common-use-cases-8"><a class="header" href="#common-use-cases-8">Common Use Cases</a></h2>
<h3 id="user-initiated-stops"><a class="header" href="#user-initiated-stops">User-Initiated Stops</a></h3>
<ul>
<li>Stopping background animations when user interacts with character</li>
<li>Interrupting long animations for more responsive interactions</li>
<li>Pausing animations during drag operations</li>
</ul>
<h3 id="state-management-1"><a class="header" href="#state-management-1">State Management</a></h3>
<ul>
<li>Stopping previous state animations before transitioning to new states</li>
<li>Clearing all animations during character resets</li>
<li>Managing animation conflicts between different behaviors</li>
</ul>
<h3 id="performance-optimization"><a class="header" href="#performance-optimization">Performance Optimization</a></h3>
<ul>
<li>Stopping resource-intensive animations when not visible</li>
<li>Limiting concurrent animations to maintain performance</li>
<li>Cleaning up animations when characters are no longer needed</li>
</ul>
<h3 id="error-recovery"><a class="header" href="#error-recovery">Error Recovery</a></h3>
<ul>
<li>Stopping problematic animations that might be causing issues</li>
<li>Resetting animation state after errors</li>
<li>Emergency stops for debugging purposes</li>
</ul>
<h2 id="related-documentation-10"><a class="header" href="#related-documentation-10">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/vrma/./index.html">VRMA Animation System</a></strong> - Main VRMA documentation</li>
<li><strong><a href="sdk/vrma/./play.html">Vrma.play()</a></strong> - Animation playback method</li>
<li><strong><a href="sdk/vrma/./Repeat.html">Repeat Class</a></strong> - Animation repeat configuration</li>
<li><strong><a href="sdk/vrma/../vrm/index.html">VRM Character Management</a></strong> - Character control and states</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gpt-api"><a class="header" href="#gpt-api">GPT API</a></h1>
<p>The GPT API provides comprehensive functionality for integrating AI language models into your mods. This includes chat
interactions, model configuration, system prompt management, web search capabilities, and voice synthesis integration.</p>
<h2 id="core-features-1"><a class="header" href="#core-features-1">Core Features</a></h2>
<ul>
<li><strong>Chat Interactions</strong>: Send messages to AI models and receive intelligent responses</li>
<li><strong>Model Management</strong>: Select and configure different AI models (GPT-3.5, GPT-4, Claude, etc.)</li>
<li><strong>System Prompts</strong>: Define AI personality and behavior through system prompts</li>
<li><strong>Web Search</strong>: Enable AI models to search the web for current information</li>
<li><strong>Voice Synthesis</strong>: Integrate with VoiceVox for text-to-speech functionality</li>
<li><strong>VRM Integration</strong>: Scope configurations to specific VRM characters</li>
</ul>
<h2 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h2>
<pre><code class="language-typescript">// Basic chat interaction
console.log(await gpt.chat("Hello, how are you?"));

// Chat with VRM character
const vrm = await Vrm.findByName("MyCharacter");
const response = await gpt.chat("Tell me a joke!", {
    vrm: vrm.entity,
});

// Configure AI model
const models = await gpt.availableModels();
await gpt.saveModel("gpt-4");

// Set system prompt
await gpt.saveSystemPrompt("You are a helpful assistant.");

// Enable web search
await gpt.saveUseWebSearch(true, {vrm: vrm.entity});
</code></pre>
<h2 id="related-apis"><a class="header" href="#related-apis">Related APIs</a></h2>
<ul>
<li><a href="sdk/gpt/../vrm/"><code>vrm</code></a> - VRM character management and interaction</li>
<li><a href="sdk/gpt/../commands/"><code>commands</code></a> - Event streaming and communication</li>
<li><a href="sdk/gpt/../effects/"><code>effects</code></a> - Visual and audio effects to complement AI responses</li>
<li><a href="sdk/gpt/../webviews/"><code>webviews</code></a> - UI integration for chat interfaces</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chat-with-ai-model"><a class="header" href="#chat-with-ai-model">Chat with AI Model</a></h1>
<p>Sends a chat message to the AI model and optionally makes a VRM speak the response.
This is the primary method for interactive conversations with AI-powered VRM characters.</p>
<h2 id="parameters-15"><a class="header" href="#parameters-15">Parameters</a></h2>
<ul>
<li><code>userMessage</code>: The message to send to the AI model</li>
<li><code>options</code>: Optional configuration for chat behavior and VRM integration</li>
</ul>
<h3 id="chatoptions"><a class="header" href="#chatoptions">ChatOptions</a></h3>
<pre><code class="language-typescript">interface ChatOptions extends SpeakOnVoiceVoxOptions {
    vrm: number; // VRM entity ID that will respond to the chat
}
</code></pre>
<h3 id="speakonvoicevoxoptions-1"><a class="header" href="#speakonvoicevoxoptions-1">SpeakOnVoiceVoxOptions</a></h3>
<pre><code class="language-typescript">interface SpeakOnVoiceVoxOptions {
    speaker?: number;           // VoiceVox speaker ID
    pause?: number;             // Pause duration in seconds between sentences
    waitForCompletion?: boolean; // Whether to wait for speech to complete
    subtitle?: SubtitleOptions; // Subtitle display configuration
}

interface SubtitleOptions {
    font?: string;        // Mod asset ID of the font to use
    fontSize?: number;    // Font size for subtitles
    color?: [number, number, number, number]; // RGBA color array [r, g, b, a]
}
</code></pre>
<h3 id="chatresponse"><a class="header" href="#chatresponse">ChatResponse</a></h3>
<pre><code class="language-typescript">interface ChatResponse {
    message: string;   // Raw AI response text
    dialogue: string;  // Processed text suitable for speech synthesis
    emotion: string;   // Detected or assigned emotion
}
</code></pre>
<h2 id="examples-13"><a class="header" href="#examples-13">Examples</a></h2>
<h3 id="basic-chat"><a class="header" href="#basic-chat">Basic Chat</a></h3>
<pre><code class="language-typescript">// Simple chat without VRM
const response = await gpt.chat("What's the weather like today?");
console.log("AI Response:", response.message);
console.log("Emotion:", response.emotion);
</code></pre>
<h3 id="vrm-character-chat"><a class="header" href="#vrm-character-chat">VRM Character Chat</a></h3>
<pre><code class="language-typescript">// Chat with VRM character that speaks the response
const vrm = await Vrm.findByName("Assistant");

const response = await gpt.chat("Tell me a interesting fact!", {
    vrm: vrm.entity,
});

console.log("Character said:", response.dialogue);
</code></pre>
<h3 id="advanced-vrm-chat-with-voice-options"><a class="header" href="#advanced-vrm-chat-with-voice-options">Advanced VRM Chat with Voice Options</a></h3>
<pre><code class="language-typescript">// Chat with custom voice settings and subtitles
const vrm = await Vrm.findByName("Guide");

const response = await gpt.chat("Welcome to Desktop Homunculus! Let me explain how this works.", {
    vrm: vrm.entity,
    speaker: 2,              // Use VoiceVox speaker ID 2
    pause: 0.5,              // Half-second pause between sentences
    waitForCompletion: true, // Wait for speech to finish
    subtitle: {
        font: "custom::arial.ttf",  // Custom font from mod assets
        fontSize: 24,               // Larger subtitle text
        color: [1.0, 1.0, 1.0, 0.9] // White text with slight transparency
    }
});

console.log("AI Response:", response.message);
console.log("Emotion detected:", response.emotion);
</code></pre>
<h2 id="related-functions-5"><a class="header" href="#related-functions-5">Related Functions</a></h2>
<ul>
<li><a href="sdk/gpt/./model.html"><code>gpt.model()</code></a> - Get current AI model</li>
<li><a href="sdk/gpt/./systemPrompt.html"><code>gpt.systemPrompt()</code></a> - Get system prompt configuration</li>
<li><a href="sdk/gpt/./useWebSearch.html"><code>gpt.useWebSearch()</code></a> - Check web search settings</li>
<li><a href="sdk/gpt/../vrm/Vrm/speakOnVoiceVox.html"><code>vrm.speakOnVoiceVox()</code></a> - Direct VRM speech synthesis</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gpt-model-management"><a class="header" href="#gpt-model-management">GPT Model Management</a></h1>
<p>Gets the current GPT model being used for AI interactions.
This function can retrieve either the global model setting or the model configured for a specific VRM character.</p>
<h2 id="parameters-16"><a class="header" href="#parameters-16">Parameters</a></h2>
<ul>
<li><code>options</code>: Optional configuration to scope the query to a specific VRM</li>
</ul>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to get model for specific character
}
</code></pre>
<h2 id="returns-14"><a class="header" href="#returns-14">Returns</a></h2>
<p>A promise that resolves to the current model name as a string.</p>
<h2 id="examples-14"><a class="header" href="#examples-14">Examples</a></h2>
<h3 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h3>
<pre><code class="language-typescript">// Get the global model setting
const currentModel = await gpt.model();
console.log("Current global model:", currentModel);
// Output: "gpt-4"

// Get model for a specific VRM character
const vrm = await Vrm.findByName("Assistant");
const vrmModel = await gpt.model({vrm: vrm.entity});
console.log("VRM model:", vrmModel);
</code></pre>
<h2 id="related-functions-6"><a class="header" href="#related-functions-6">Related Functions</a></h2>
<ul>
<li><a href="sdk/gpt/./availableModels.html"><code>gpt.availableModels()</code></a> - Get list of available models</li>
<li><a href="sdk/gpt/./saveModel.html"><code>gpt.saveModel()</code></a> - Change the active model</li>
<li><a href="sdk/gpt/./chat.html"><code>gpt.chat()</code></a> - Use the current model for conversations</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-prompt"><a class="header" href="#system-prompt">System Prompt</a></h1>
<p>Controls system prompt used to configure AI behavior.
The system prompt defines the AI's personality, role, and behavioral guidelines that influence how it responds to user
messages.</p>
<h2 id="gptsystemprompt"><a class="header" href="#gptsystemprompt">gpt.systemPrompt()</a></h2>
<h3 id="parameters-17"><a class="header" href="#parameters-17">Parameters</a></h3>
<ul>
<li><code>options</code>: Optional configuration to scope the query to a specific VRM</li>
</ul>
<h4 id="options-1"><a class="header" href="#options-1">Options</a></h4>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to get system prompt for specific character
}
</code></pre>
<h2 id="returns-15"><a class="header" href="#returns-15">Returns</a></h2>
<p>A promise that resolves to the current system prompt as a string.</p>
<h2 id="gptsavesystemprompt"><a class="header" href="#gptsavesystemprompt">gpt.saveSystemPrompt()</a></h2>
<h3 id="parameters-18"><a class="header" href="#parameters-18">Parameters</a></h3>
<ul>
<li><code>prompt</code>: The system prompt text to set</li>
<li><code>options</code>: Optional configuration to scope the setting to a specific VRM</li>
</ul>
<h4 id="options-2"><a class="header" href="#options-2">Options</a></h4>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to set system prompt for specific character
}
</code></pre>
<h2 id="examples-15"><a class="header" href="#examples-15">Examples</a></h2>
<h3 id="basic-usage-1"><a class="header" href="#basic-usage-1">Basic Usage</a></h3>
<pre><code class="language-typescript">// Get the global system prompt
const globalPrompt = await gpt.systemPrompt();
console.log("Global system prompt:", globalPrompt);

// Get system prompt for a specific VRM character
const vrm = await Vrm.findByName("Assistant");
const vrmPrompt = await gpt.systemPrompt({vrm: vrm.entity});
console.log("VRM system prompt:", vrmPrompt);
</code></pre>
<h2 id="related-functions-7"><a class="header" href="#related-functions-7">Related Functions</a></h2>
<ul>
<li><a href="sdk/gpt/./saveSystemPrompt.html"><code>gpt.saveSystemPrompt()</code></a> - Set the system prompt</li>
<li><a href="sdk/gpt/./chat.html"><code>gpt.chat()</code></a> - Use the system prompt in conversations</li>
<li><a href="sdk/gpt/./model.html"><code>gpt.model()</code></a> - Check which model will use the system prompt</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-search"><a class="header" href="#web-search">Web Search</a></h1>
<p>Controls the web search setting for GPT interactions.
When enabled, the AI can search the web for current information to enhance responses with up-to-date data.</p>
<blockquote>
<p>[!WARNING]
To use this feature, the ChatGPT model must support web search.</p>
</blockquote>
<h2 id="gptusewebsearch"><a class="header" href="#gptusewebsearch">gpt.useWebSearch()</a></h2>
<h3 id="parameters-19"><a class="header" href="#parameters-19">Parameters</a></h3>
<ul>
<li><code>options</code>: Optional configuration to scope the query to a specific VRM</li>
</ul>
<h3 id="options-3"><a class="header" href="#options-3">Options</a></h3>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to get web search setting for specific character
}
</code></pre>
<h3 id="returns-16"><a class="header" href="#returns-16">Returns</a></h3>
<p>A promise that resolves to the current web search setting as a boolean.</p>
<h2 id="gptsaveusewebsearch"><a class="header" href="#gptsaveusewebsearch">gpt.saveUseWebSearch()</a></h2>
<h3 id="parameters-20"><a class="header" href="#parameters-20">Parameters</a></h3>
<ul>
<li><code>model</code>: The model name to set (must be from the available models list)</li>
<li><code>options</code>: Optional configuration to scope the setting to a specific VRM</li>
</ul>
<h3 id="options-4"><a class="header" href="#options-4">Options</a></h3>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to set model for specific character
}
</code></pre>
<h2 id="examples-16"><a class="header" href="#examples-16">Examples</a></h2>
<h3 id="basic-usage-2"><a class="header" href="#basic-usage-2">Basic Usage</a></h3>
<pre><code class="language-typescript">// Check global web search setting
const globalWebSearch = await gpt.useWebSearch();
console.log("Global web search enabled:", globalWebSearch);

// Check web search setting for specific VRM character
const vrm = await Vrm.findByName("NewsBot");
await gpt.saveUseWebSearch(true, {vrm: vrm.entity});
const vrmWebSearch = await gpt.useWebSearch({vrm: vrm.entity});
console.log("NewsBot web search enabled:", vrmWebSearch);
</code></pre>
<h2 id="related-functions-8"><a class="header" href="#related-functions-8">Related Functions</a></h2>
<ul>
<li><a href="sdk/gpt/./saveUseWebSearch.html"><code>gpt.saveUseWebSearch()</code></a> - Enable/disable web search</li>
<li><a href="sdk/gpt/./chat.html"><code>gpt.chat()</code></a> - Use web search in conversations</li>
<li><a href="sdk/gpt/./systemPrompt.html"><code>gpt.systemPrompt()</code></a> - Configure how characters use web search information</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="voicevox-speaker"><a class="header" href="#voicevox-speaker">Voicevox Speaker</a></h1>
<p>Gets the current VoiceVox speaker ID used for text-to-speech synthesis.
VoiceVox speakers represent different voice characters with unique tones, styles, and personalities that can be used to
give your VRM characters distinct voices.</p>
<h2 id="parameters-21"><a class="header" href="#parameters-21">Parameters</a></h2>
<ul>
<li><code>options</code>: Optional configuration to scope the query to a specific VRM</li>
</ul>
<h3 id="options-5"><a class="header" href="#options-5">Options</a></h3>
<pre><code class="language-typescript">interface Options {
    vrm?: number; // VRM entity ID to get VoiceVox speaker for specific character
}
</code></pre>
<h2 id="returns-17"><a class="header" href="#returns-17">Returns</a></h2>
<p>A promise that resolves to the current VoiceVox speaker ID as a number.</p>
<h2 id="examples-17"><a class="header" href="#examples-17">Examples</a></h2>
<h3 id="basic-usage-3"><a class="header" href="#basic-usage-3">Basic Usage</a></h3>
<pre><code class="language-typescript">// Get global VoiceVox speaker setting
const globalSpeaker = await gpt.voicevoxSpeaker();
console.log("Global VoiceVox speaker:", globalSpeaker);

// Get VoiceVox speaker for specific VRM character
const vrm = await Vrm.findByName("Assistant");
const vrmSpeaker = await gpt.voicevoxSpeaker({vrm: vrm.entity});
console.log("Assistant VoiceVox speaker:", vrmSpeaker);
</code></pre>
<h2 id="related-functions-9"><a class="header" href="#related-functions-9">Related Functions</a></h2>
<ul>
<li><a href="sdk/gpt/./saveVoicevoxSpeaker.html"><code>gpt.saveVoicevoxSpeaker()</code></a> - Set VoiceVox speaker for character</li>
<li><a href="sdk/gpt/./chat.html"><code>gpt.chat()</code></a> - Use VoiceVox speaker in conversations</li>
<li><a href="sdk/gpt/../vrm/speakOnVoiceVox.html"><code>vrm.speakOnVoiceVox()</code></a> - Direct VRM speech synthesis</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webview-management"><a class="header" href="#webview-management">Webview Management</a></h1>
<p>The Webview Management system provides comprehensive control over embedded web windows in Desktop Homunculus. This
powerful API allows you to create, position, and manage HTML-based user interfaces that can be attached to VRM
characters or positioned anywhere in 3D space.</p>
<h2 id="overview-6"><a class="header" href="#overview-6">Overview</a></h2>
<p>Webviews are embedded browser windows that serve as the primary UI technology for Desktop Homunculus MODs. They offer:</p>
<ul>
<li><strong>3D Positioning</strong>: Place interfaces anywhere in 3D space relative to characters or screen coordinates</li>
<li><strong>Character Attachment</strong>: Attach UIs to specific VRM bones that track movement</li>
<li><strong>Transparency</strong>: Create seamless overlays that blend with the desktop</li>
<li><strong>Full HTML/CSS/JS</strong>: Use modern web technologies for rich interfaces</li>
<li><strong>Real-Time Communication</strong>: Integrate with the TypeScript SDK and HTTP API</li>
</ul>
<h2 id="core-concepts-2"><a class="header" href="#core-concepts-2">Core Concepts</a></h2>
<h3 id="positioning-types"><a class="header" href="#positioning-types">Positioning Types</a></h3>
<ul>
<li><strong>Fixed Screen Position</strong>: Traditional window positioning at pixel coordinates</li>
<li><strong>VRM-Relative</strong>: Positioned relative to VRM character bones</li>
<li><strong>Tracking</strong>: Webviews that follow character movement in real-time</li>
</ul>
<h3 id="visual-configuration"><a class="header" href="#visual-configuration">Visual Configuration</a></h3>
<ul>
<li><strong>Transparency</strong>: Alpha blending with desktop background</li>
<li><strong>Custom Resolution</strong>: Precise width/height control</li>
<li><strong>Toolbar Management</strong>: Show/hide browser controls</li>
<li><strong>Audio Feedback</strong>: Sound effects for open/close operations</li>
</ul>
<h2 id="api-reference-1"><a class="header" href="#api-reference-1">API Reference</a></h2>
<h3 id="webview-class"><a class="header" href="#webview-class">Webview Class</a></h3>
<p>The main class for managing webview instances.</p>
<h4 id="constructor-1"><a class="header" href="#constructor-1">Constructor</a></h4>
<pre><code class="language-typescript">new Webview(entity: number)
</code></pre>
<p>Creates a webview instance wrapper around an entity ID. Typically not called directly - use static methods like <code>Webview.open()</code> instead.</p>
<h4 id="instance-methods"><a class="header" href="#instance-methods">Instance Methods</a></h4>
<ul>
<li><strong><a href="sdk/webviews/./close.html">close()</a></strong> - Close the webview window</li>
<li><strong><a href="sdk/webviews/./isClosed.html">isClosed()</a></strong> - Check if webview has been closed</li>
</ul>
<h4 id="static-methods"><a class="header" href="#static-methods">Static Methods</a></h4>
<ul>
<li><strong><a href="sdk/webviews/./open.html">open(options)</a></strong> - Create and open a new webview</li>
<li><strong><a href="sdk/webviews/./current.html">current()</a></strong> - Get current webview instance</li>
</ul>
<h2 id="basic-example"><a class="header" href="#basic-example">Basic Example</a></h2>
<pre><code class="language-typescript">import { Webview } from '@homunculus/sdk';

// Create a simple settings panel
const settingsPanel = await Webview.open({
    source: 'my-mod/settings.html',
    position: [100, 100],
    resolution: [400, 300],
    transparent: false,
    showToolbar: true
});

// Close when done
await settingsPanel.close();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webviewopen"><a class="header" href="#webviewopen">Webview.open()</a></h1>
<p>Creates and opens a new webview displaying content from a mod asset or URL.</p>
<h2 id="parameters-22"><a class="header" href="#parameters-22">Parameters</a></h2>
<ul>
<li><code>options</code> (OpenOptions, optional) - Configuration options for the webview</li>
</ul>
<h3 id="openoptions"><a class="header" href="#openoptions">OpenOptions</a></h3>
<pre><code class="language-typescript">interface OpenOptions {
    asset: string;                     // Required mod asset ID for webview content
    caller?: number;                   // VRM entity ID that owns this webview
    transparent?: boolean;             // Whether background is transparent
    showToolbar?: boolean;             // Whether to show browser toolbar
    shadow?: boolean;                  // Whether window casts shadow (macOS only)
    position?: OpenPosition;           // Positioning configuration
    resolution?: [number, number];     // Width and height in pixels
    sounds?: {
        open?: string;                // Sound played when opening webview
        close?: string;               // Sound played when closing webview
    }
}
</code></pre>
<h3 id="openposition"><a class="header" href="#openposition">OpenPosition</a></h3>
<p>Position can be either fixed screen coordinates or VRM-relative:</p>
<pre><code class="language-typescript">type OpenPosition = [number, number] | OpenAroundVrm

interface OpenAroundVrm {
    vrm: number;                       // VRM entity ID to attach to
    offset?: [number, number];         // Pixel offset from attachment point
    bone?: string;                     // VRM bone name to attach to
    tracking?: boolean;                // Whether to follow VRM movement
}
</code></pre>
<h2 id="returns-18"><a class="header" href="#returns-18">Returns</a></h2>
<p><code>Promise&lt;Webview&gt;</code> - A new webview instance that can be controlled and closed</p>
<h2 id="description-5"><a class="header" href="#description-5">Description</a></h2>
<p>The <code>open()</code> method creates a new embedded browser window that can display HTML content from mod assets or external
URLs. Webviews can be positioned at fixed screen coordinates or attached to VRM characters for dynamic interfaces.</p>
<h2 id="examples-18"><a class="header" href="#examples-18">Examples</a></h2>
<h3 id="basic-webview"><a class="header" href="#basic-webview">Basic Webview</a></h3>
<pre><code class="language-typescript">import {Webview} from '@homunculus/sdk';

// Simple webview with default settings
const panel = await Webview.open({
    asset: 'my-ui-mod::settings.html'
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webviewclose"><a class="header" href="#webviewclose">webview.close()</a></h1>
<p>Closes the webview window and removes it from the application.</p>
<h2 id="parameters-23"><a class="header" href="#parameters-23">Parameters</a></h2>
<p>None.</p>
<h2 id="returns-19"><a class="header" href="#returns-19">Returns</a></h2>
<p><code>Promise&lt;void&gt;</code> - Resolves when the webview has been closed</p>
<h2 id="description-6"><a class="header" href="#description-6">Description</a></h2>
<p>The <code>close()</code> method removes the webview from the screen and cleans up its resources. If a close sound effect was
configured when the webview was opened, it will be played before the webview is destroyed.</p>
<h2 id="example-1"><a class="header" href="#example-1">Example</a></h2>
<pre><code class="language-typescript">import {Webview} from '@homunculus/sdk';

// Open a webview
const panel = await Webview.open({
    source: 'ui/settings.html',
});

// Use the webview...

// Close it when done
await panel.close();
console.log('Webview closed');
</code></pre>
<h2 id="related-documentation-11"><a class="header" href="#related-documentation-11">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/webviews/./open.html">Webview.open()</a></strong> - Creating webviews</li>
<li><strong><a href="sdk/webviews/./isClosed.html">webview.isClosed()</a></strong> - Checking webview status</li>
<li><strong><a href="sdk/webviews/./index.html">Webview Management</a></strong> - Overview of webview system</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webviewisclosed"><a class="header" href="#webviewisclosed">webview.isClosed()</a></h1>
<p>Checks whether the webview has been closed and is no longer available.</p>
<h2 id="parameters-24"><a class="header" href="#parameters-24">Parameters</a></h2>
<p>None.</p>
<h2 id="returns-20"><a class="header" href="#returns-20">Returns</a></h2>
<p><code>Promise&lt;boolean&gt;</code> - Returns <code>true</code> if the webview is closed, <code>false</code> if it's still open</p>
<h2 id="description-7"><a class="header" href="#description-7">Description</a></h2>
<p>The <code>isClosed()</code> method allows you to check if a webview instance is still active. This is useful for conditional
operations, cleanup logic, and preventing operations on closed webviews.</p>
<h2 id="example-2"><a class="header" href="#example-2">Example</a></h2>
<pre><code class="language-typescript">import {Webview} from '@homunculus/sdk';

const panel = await Webview.open({
    source: 'ui/status-panel.html'
});

// Check if webview is still open
if (!(await panel.isClosed())) {
    console.log('Panel is still open');
    // Safe to perform operations
} else {
    console.log('Panel has been closed');
    // Don't try to use the webview
}
</code></pre>
<h2 id="related-documentation-12"><a class="header" href="#related-documentation-12">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/webviews/./close.html">webview.close()</a></strong> - Closing webviews</li>
<li><strong><a href="sdk/webviews/./open.html">Webview.open()</a></strong> - Creating webviews</li>
<li><strong><a href="sdk/webviews/./index.html">Webview Management</a></strong> - Overview of webview system</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="effects-api"><a class="header" href="#effects-api">Effects API</a></h1>
<p>The Effects API provides functionality for playing visual and audio effects. It allows you to trigger various effects
that enhance the user experience, including sound effects and visual stamp effects that can be displayed on any monitor.</p>
<h2 id="key-features"><a class="header" href="#key-features">Key Features</a></h2>
<ul>
<li><strong>Sound Effect Playback</strong>: Play audio effects from mod assets</li>
<li><strong>Visual Stamp Effects</strong>: Display temporary visual elements with customizable positioning and timing</li>
<li><strong>Multi-monitor Support</strong>: Target specific displays for effect placement</li>
<li><strong>Asset-based System</strong>: All effects reference mod assets for their content</li>
</ul>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<ul>
<li><a href="sdk/effects/./sound.html"><code>sound()</code></a> - Play audio effects from mod assets</li>
<li><a href="sdk/effects/./stamp.html"><code>stamp()</code></a> - Display visual stamp effects with customizable options</li>
</ul>
<h2 id="quick-example-1"><a class="header" href="#quick-example-1">Quick Example</a></h2>
<pre><code class="language-typescript">// Play a sound effect
await effects.sound("notification-sounds/ding.wav");

// Show a stamp effect at a random position
await effects.stamp("reaction-images/heart.png", {
    size: [100, 100],
    durationSecs: 2.0
});

// Show stamp effect on a specific display with bounds
const displays = await displays.findAll();
await effects.stamp("celebrations/confetti.gif", {
    display: displays[1].id,  // Second monitor
    bounds: {
        min: [100, 100],
        max: [500, 400]
    },
    size: [200, 200],
    durationSecs: 3.0
});
</code></pre>
<h2 id="common-use-cases-9"><a class="header" href="#common-use-cases-9">Common Use Cases</a></h2>
<ul>
<li><strong>User Feedback</strong>: Provide audio and visual feedback for user interactions</li>
<li><strong>Notifications</strong>: Alert users with sound and visual cues</li>
<li><strong>Celebrations</strong>: Show congratulatory effects for achievements</li>
<li><strong>Ambient Effects</strong>: Create atmospheric visual and audio experiences</li>
<li><strong>Interactive Responses</strong>: React to VRM interactions with appropriate effects</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sound-effects"><a class="header" href="#sound-effects">Sound Effects</a></h1>
<p>Plays a sound effect from a mod asset.</p>
<p>Sound effects are played immediately and do not block execution.
The sound file must be included in a mod's assets directory.
Supports common audio formats like WAV, MP3, and OGG.</p>
<h2 id="parameters-25"><a class="header" href="#parameters-25">Parameters</a></h2>
<ul>
<li><code>source</code>: The mod asset path relative to the <code>assets/mods</code> directory.</li>
</ul>
<h2 id="examples-19"><a class="header" href="#examples-19">Examples</a></h2>
<h3 id="basic-sound-effects"><a class="header" href="#basic-sound-effects">Basic Sound Effects</a></h3>
<pre><code class="language-typescript">// Play notification sounds
await effects.sound("ui-sounds/button-click.wav");
await effects.sound("notifications/message-received.mp3");
await effects.sound("character-voices/greeting.ogg");
</code></pre>
<h2 id="related-functions-10"><a class="header" href="#related-functions-10">Related Functions</a></h2>
<ul>
<li><a href="sdk/effects/./stamp.html"><code>stamp()</code></a> - Display visual effects alongside sounds</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stamp-effects"><a class="header" href="#stamp-effects">Stamp Effects</a></h1>
<p>Displays a visual stamp effect on the screen using an image from mod assets.</p>
<p>Stamp effects are temporary visual elements that appear on screen for a short time.
They can be used for reactions, notifications, celebrations, or visual feedback. The image will appear at a random
position within the specified bounds.</p>
<h2 id="parameters-26"><a class="header" href="#parameters-26">Parameters</a></h2>
<ul>
<li><code>source</code>: The mod image asset path relative to the <code>assets/mods</code> directory (e.g., <code>reactions/thumbs-up.png</code>)</li>
<li><code>options</code>: Optional configuration for the stamp appearance and behavior</li>
</ul>
<h3 id="stampoptions"><a class="header" href="#stampoptions">StampOptions</a></h3>
<ul>
<li><code>display?</code>: Display/monitor ID to show the effect on</li>
<li><code>bounds?</code>: Rectangular area where the stamp can appear (random position within bounds)</li>
<li><code>size?</code>: Size of the stamp effect in pixels [width, height] (default: [300, 300])</li>
<li><code>durationSecs?</code>: How long the stamp remains visible in seconds (default: 0.8)</li>
</ul>
<h2 id="examples-20"><a class="header" href="#examples-20">Examples</a></h2>
<h3 id="simple-stamp-effects"><a class="header" href="#simple-stamp-effects">Simple Stamp Effects</a></h3>
<pre><code class="language-typescript">// Simple stamp with default settings
await effects.stamp("reactions/thumbs-up.png");

// Customized stamp effect
await effects.stamp("celebrations/party.gif", {
    size: [150, 150],
    durationSecs: 2.5,
    bounds: {
        min: [200, 100],  // Top-left of allowed area
        max: [800, 500]   // Bottom-right of allowed area
    }
});
</code></pre>
<h2 id="related-functions-11"><a class="header" href="#related-functions-11">Related Functions</a></h2>
<ul>
<li><a href="sdk/effects/./sound.html"><code>sound()</code></a> - Play audio effects alongside visual stamps</li>
<li><a href="sdk/effects/../displays/findAll.html"><code>displays.findAll()</code></a> - Target specific monitors for effects</li>
<li><a href="sdk/effects/../cameras/worldToGlobalViewport.html"><code>cameras.worldToGlobalViewport()</code></a> - Position effects relative to 3D objects</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commands-api"><a class="header" href="#commands-api">Commands API</a></h1>
<p>The Commands API provides a pub/sub mechanism for cross-process communication. It allows external processes to communicate with the Desktop Homunculus application and its mods through event streaming.</p>
<h2 id="key-features-1"><a class="header" href="#key-features-1">Key Features</a></h2>
<ul>
<li><strong>Real-time Event Streaming</strong>: Uses Server-Sent Events (SSE) for real-time communication</li>
<li><strong>Command Broadcasting</strong>: Send commands to multiple subscribers</li>
<li><strong>Type-safe Payload Handling</strong>: Full TypeScript support for message payloads</li>
<li><strong>Cross-Process Communication</strong>: Enable communication between different parts of the system</li>
</ul>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<ul>
<li><a href="sdk/commands/./send.html"><code>send()</code></a> - Send commands to all listeners on a channel</li>
<li><a href="sdk/commands/./stream.html"><code>stream()</code></a> - Listen for commands on a specific channel</li>
</ul>
<h2 id="quick-example-2"><a class="header" href="#quick-example-2">Quick Example</a></h2>
<pre><code class="language-typescript">// Listen for custom events from external processes
const eventSource = commands.stream&lt;{action: string, data: any}&gt;(
  "my-custom-command",
  (payload) =&gt; {
    console.log("Received command:", payload.action, payload.data);
  }
);

// Send commands to all listeners
await commands.send("my-custom-command", {
  action: "update",
  data: { message: "Hello from external app!" }
});

// Clean up when done
eventSource.close();
</code></pre>
<h2 id="common-use-cases-10"><a class="header" href="#common-use-cases-10">Common Use Cases</a></h2>
<ul>
<li><strong>Inter-MOD Communication</strong>: Enable mods to communicate with each other</li>
<li><strong>External Integration</strong>: Allow external applications to control Desktop Homunculus</li>
<li><strong>Real-time Updates</strong>: Stream live data between different components</li>
<li><strong>Event Coordination</strong>: Synchronize actions across multiple systems</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="streaming-commands"><a class="header" href="#streaming-commands">Streaming Commands</a></h1>
<p>Creates a persistent connection to stream command events of a specific type.</p>
<p>This establishes a Server-Sent Events (SSE) connection that will receive all commands sent to the specified command
channel. The connection remains open until explicitly closed.</p>
<h2 id="parameters-27"><a class="header" href="#parameters-27">Parameters</a></h2>
<ul>
<li><code>command</code>: The command channel name to subscribe to</li>
<li><code>f</code>: Callback function to handle received payloads</li>
</ul>
<h2 id="returns-21"><a class="header" href="#returns-21">Returns</a></h2>
<p>EventSource instance for managing the connection</p>
<h2 id="examples-21"><a class="header" href="#examples-21">Examples</a></h2>
<h3 id="listen-for-user-interaction-events"><a class="header" href="#listen-for-user-interaction-events">Listen for User Interaction Events</a></h3>
<pre><code class="language-typescript">// Listen for user interaction events
interface UserAction {
    type: 'click' | 'hover' | 'scroll';
    position: [number, number];
    timestamp: number;
}

const userEventStream = commands.stream&lt;UserAction&gt;(
    "user-interactions",
    async (action) =&gt; {
        console.log(`User ${action.type} at`, action.position);

        // Process the user action
        switch (action.type) {
            case 'click':
                await effects.stamp('click-effect/ripple.gif');
                break;
            case 'hover':
                await effects.sound('ui-sounds/hover.wav');
                break;
        }
    }
);

// Later, close the stream
userEventStream.close();
</code></pre>
<h3 id="cross-mod-communication"><a class="header" href="#cross-mod-communication">Cross-MOD Communication</a></h3>
<pre><code class="language-typescript">// MOD B: Listen for data from MOD A
interface SharedData {
    userId: string;
    preferences: {
        theme: 'dark' | 'light';
        volume: number;
    };
}

const dataSync = commands.stream&lt;SharedData&gt;(
    "user-data-sync",
    async (userData) =&gt; {
        console.log(`Received user data for ${userData.userId}`);

        // Apply preferences to this MOD
        if (userData.preferences.theme === 'dark') {
            document.body.classList.add('dark-theme');
        }

        // Store locally for this MOD
        await preferences.save('synced-user-data', userData);
    }
);
</code></pre>
<h3 id="notification-system"><a class="header" href="#notification-system">Notification System</a></h3>
<pre><code class="language-typescript">// Listen for system notifications
interface Notification {
    type: 'info' | 'warning' | 'error' | 'success';
    title: string;
    message: string;
    timestamp: number;
    duration?: number;
}

const notificationStream = commands.stream&lt;Notification&gt;(
    "notifications",
    async (notification) =&gt; {
        // Show notification in UI
        showNotificationUI(notification);

        // Play appropriate sound
        const soundMap = {
            info: 'ui-sounds/info.wav',
            warning: 'ui-sounds/warning.wav',
            error: 'ui-sounds/error.wav',
            success: 'ui-sounds/success.wav'
        };

        await effects.sound(soundMap[notification.type]);

        // Log important notifications
        if (notification.type === 'error') {
            console.error(`[${notification.title}] ${notification.message}`);
        }
    }
);
</code></pre>
<h2 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h2>
<ul>
<li><strong>Real-time Updates</strong>: Receive live data from external sources</li>
<li><strong>Inter-MOD Communication</strong>: Listen for messages from other MODs</li>
<li><strong>User Interface Events</strong>: Handle UI interactions from other components</li>
<li><strong>System Monitoring</strong>: Monitor application state changes</li>
<li><strong>Gaming Events</strong>: Handle real-time game events and player actions</li>
<li><strong>Notification Systems</strong>: Receive and display system notifications</li>
</ul>
<h2 id="related-functions-12"><a class="header" href="#related-functions-12">Related Functions</a></h2>
<ul>
<li><a href="sdk/commands/./send.html"><code>send()</code></a> - Send commands to a specific channel</li>
<li><a href="sdk/commands/../webviews/open.html"><code>webviews.open()</code></a> - Create webviews that can stream commands</li>
<li><a href="sdk/commands/../preferences/load.html"><code>preferences.load()</code></a> - Load data that's shared via commands</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sending-commands"><a class="header" href="#sending-commands">Sending Commands</a></h1>
<p>Sends a command payload to all subscribers listening to the specified command channel.</p>
<p>This broadcasts the payload to all active EventSource connections that are streaming the same command type. The
operation is asynchronous and will complete once the command has been distributed to all subscribers.</p>
<h2 id="parameters-28"><a class="header" href="#parameters-28">Parameters</a></h2>
<ul>
<li><code>command</code>: The command channel name to broadcast to</li>
<li><code>payload</code>: The data to send to all subscribers (must be JSON-serializable)</li>
</ul>
<h2 id="examples-22"><a class="header" href="#examples-22">Examples</a></h2>
<h3 id="send-notification-to-all-mod-windows"><a class="header" href="#send-notification-to-all-mod-windows">Send Notification to All MOD Windows</a></h3>
<pre><code class="language-typescript">// Send a notification to all mod windows
await commands.send("notifications", {
    type: "info",
    title: "Update Available",
    message: "A new version of the character is available",
    timestamp: Date.now()
});
</code></pre>
<h2 id="related-functions-13"><a class="header" href="#related-functions-13">Related Functions</a></h2>
<ul>
<li><a href="sdk/commands/./stream.html"><code>stream()</code></a> - Listen for commands on a specific channel</li>
<li><a href="sdk/commands/../webviews/open.html"><code>webviews.open()</code></a> - Create webviews that can receive commands</li>
<li><a href="sdk/commands/../preferences/save.html"><code>preferences.save()</code></a> - Persist data that's shared via commands</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="displays-api"><a class="header" href="#displays-api">Displays API</a></h1>
<p>The Displays API provides functionality for monitor and screen management. It allows you to query information about connected displays/monitors, including their dimensions, positions, and identifiers. This is essential for multi-monitor setups where you need to target specific screens for effects, webviews, or VRM positioning.</p>
<h2 id="key-features-2"><a class="header" href="#key-features-2">Key Features</a></h2>
<ul>
<li><strong>Discovery of Connected Displays</strong>: Find all available displays/monitors</li>
<li><strong>Display Identification</strong>: Get unique identifiers and metadata for each display</li>
<li><strong>Screen Bounds Information</strong>: Access position and dimension data</li>
<li><strong>Multi-monitor Support</strong>: Target specific screens for various operations</li>
</ul>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<ul>
<li><a href="sdk/displays/./findAll.html"><code>findAll()</code></a> - Get information about all connected displays</li>
</ul>
<h2 id="quick-example-3"><a class="header" href="#quick-example-3">Quick Example</a></h2>
<pre><code class="language-typescript">// Get information about all connected displays
const allDisplays = await displays.findAll();

console.log(`Found ${allDisplays.length} displays:`);
allDisplays.forEach((display, index) =&gt; {
  console.log(`Display ${index + 1}:`);
  console.log(`  ID: ${display.id}`);
  console.log(`  Title: ${display.title}`);
  console.log(`  Size: ${display.frame.max[0]}x${display.frame.max[1]}`);
  console.log(`  Position: (${display.frame.min[0]}, ${display.frame.min[1]})`);
});

// Target a specific display for effects
const primaryDisplay = allDisplays[0];
await effects.stamp("celebration/confetti.gif", {
  display: primaryDisplay.id,
  bounds: primaryDisplay.frame
});

// Open webview on secondary monitor
if (allDisplays.length &gt; 1) {
  const secondaryDisplay = allDisplays[1];
  await Webview.open("dashboard", {
    position: [
      secondaryDisplay.frame.min[0] + 100,
      secondaryDisplay.frame.min[1] + 100
    ]
  });
}
</code></pre>
<h2 id="common-use-cases-11"><a class="header" href="#common-use-cases-11">Common Use Cases</a></h2>
<ul>
<li><strong>Multi-monitor Applications</strong>: Position content on specific monitors</li>
<li><strong>Display Awareness</strong>: Adapt UI based on available screen real estate</li>
<li><strong>Effect Targeting</strong>: Show effects on specific displays</li>
<li><strong>Window Management</strong>: Position webviews and UI elements precisely</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="find-all-displays"><a class="header" href="#find-all-displays">Find All Displays</a></h1>
<p>Retrieves information about all currently connected displays/monitors.</p>
<p>This function queries the system to get real-time information about all available displays,
including their positions, sizes, and identifiers. The returned array includes both primary and secondary displays.</p>
<h2 id="returns-22"><a class="header" href="#returns-22">Returns</a></h2>
<p>Promise that resolves to an array of <code>Display</code> objects, each containing:</p>
<ul>
<li><code>id</code>: Unique identifier for the display</li>
<li><code>title</code>: Human-readable name/title of the display</li>
<li><code>frame</code>: Rectangular bounds with <code>min</code> and <code>max</code> coordinates</li>
</ul>
<h2 id="examples-23"><a class="header" href="#examples-23">Examples</a></h2>
<h3 id="basic-display-enumeration"><a class="header" href="#basic-display-enumeration">Basic Display Enumeration</a></h3>
<pre><code class="language-typescript">// Get all displays
const allDisplays = await displays.findAll();
console.log(`System has ${allDisplays.length} displays`);

// Display detailed information
allDisplays.forEach((display, index) =&gt; {
    const width = display.frame.max[0] - display.frame.min[0];
    const height = display.frame.max[1] - display.frame.min[1];

    console.log(`Display ${index + 1}: ${display.title}`);
    console.log(`  Resolution: ${width}x${height}`);
    console.log(`  Position: (${display.frame.min[0]}, ${display.frame.min[1]})`);
});
</code></pre>
<h2 id="related-functions-14"><a class="header" href="#related-functions-14">Related Functions</a></h2>
<ul>
<li><a href="sdk/displays/../effects/stamp.html"><code>effects.stamp()</code></a> - Display effects on specific monitors</li>
<li><a href="sdk/displays/../webviews/open.html"><code>webviews.open()</code></a> - Position webviews on specific displays</li>
<li><a href="sdk/displays/../cameras/worldToGlobalViewport.html"><code>cameras.worldToGlobalViewport()</code></a> - Convert world coordinates to screen
positions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="preferences"><a class="header" href="#preferences">Preferences</a></h1>
<p>The Preferences API provides persistent data storage for mods, allowing you to save and load configuration data, user
settings, and application state that persists across sessions. This is ideal for storing user preferences, character
positions, mod configurations, and any other data that should be remembered between application runs.</p>
<h2 id="key-features-3"><a class="header" href="#key-features-3">Key Features</a></h2>
<ul>
<li><strong>Type-safe Storage</strong>: Generic functions with TypeScript type safety</li>
<li><strong>JSON Serialization</strong>: Automatic serialization and deserialization of data</li>
<li><strong>VRM Transform Helpers</strong>: Specialized functions for saving character positions</li>
<li><strong>Cross-session Persistence</strong>: Data survives application restarts</li>
<li><strong>Error Handling</strong>: Graceful handling of missing keys and parse errors</li>
</ul>
<h2 id="quick-example-4"><a class="header" href="#quick-example-4">Quick Example</a></h2>
<pre><code class="language-typescript">import {preferences} from '@homunculus/sdk';

// Save user settings
interface UserSettings {
    theme: 'dark' | 'light';
    volume: number;
    autoSave: boolean;
}

const settings: UserSettings = {
    theme: 'dark',
    volume: 0.8,
    autoSave: true
};

await preferences.save('user-settings', settings);

// Load settings with type safety
const loadedSettings = await preferences.load&lt;UserSettings&gt;('user-settings');
console.log(`Theme: ${loadedSettings.theme}`);

// Save and restore character positions
const vrm = await Vrm.findByName('MyCharacter');
const transform = await entities.transform(vrm.entity);
await preferences.saveVrmTransform('MyCharacter', transform);

// Later...
const savedTransform = await preferences.loadVrmTransform('MyCharacter');
await entities.setTransform(vrm.entity, savedTransform);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="load-preferences"><a class="header" href="#load-preferences">Load Preferences</a></h1>
<p>Loads a value from the preference store with type safety and automatic JSON deserialization.</p>
<h2 id="parameters-29"><a class="header" href="#parameters-29">Parameters</a></h2>
<ul>
<li><code>key</code> (string) - The unique identifier for the stored data</li>
</ul>
<h2 id="returns-23"><a class="header" href="#returns-23">Returns</a></h2>
<p><code>Promise&lt;V&gt;</code> - A promise that resolves to the deserialized value of the specified type</p>
<h2 id="description-8"><a class="header" href="#description-8">Description</a></h2>
<p>The <code>load()</code> function retrieves and deserializes data that was previously saved with the same key. The data is
automatically parsed from JSON format back to the original type. If the key does not exist or cannot be parsed, the
function will throw an error.</p>
<h2 id="examples-24"><a class="header" href="#examples-24">Examples</a></h2>
<h3 id="basic-data-loading"><a class="header" href="#basic-data-loading">Basic Data Loading</a></h3>
<pre><code class="language-typescript">import {preferences} from '@homunculus/sdk';

// Load simple values
const username = await preferences.load&lt;string&gt;('username');
const volume = await preferences.load&lt;number&gt;('audio-volume');
const isFirstRun = await preferences.load&lt;boolean&gt;('first-run');

console.log(`Welcome back, ${username}!`);
</code></pre>
<h2 id="related-functions-15"><a class="header" href="#related-functions-15">Related Functions</a></h2>
<ul>
<li><a href="sdk/preferences/./save.html"><code>save()</code></a> - Save data to the preferences store</li>
<li><a href="sdk/preferences/./loadVrmTransform.html"><code>loadVrmTransform()</code></a> - Load VRM character positions</li>
<li><a href="sdk/preferences/./saveVrmTransform.html"><code>saveVrmTransform()</code></a> - Save VRM character positions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="save-preferences"><a class="header" href="#save-preferences">Save Preferences</a></h1>
<p>Saves a value to the preference store with automatic JSON serialization for persistent storage.</p>
<p>The <code>save()</code> function stores data persistently using JSON serialization. The data will be available across application
restarts and can be retrieved using the same key with <code>load()</code>. If a value already exists for the given key, it will be
overwritten.</p>
<h2 id="parameters-30"><a class="header" href="#parameters-30">Parameters</a></h2>
<ul>
<li><code>key</code> (string) - The unique identifier for storing the data</li>
<li><code>value</code> (V) - The data to save (must be JSON-serializable)</li>
</ul>
<h2 id="returns-24"><a class="header" href="#returns-24">Returns</a></h2>
<p><code>Promise&lt;void&gt;</code> - A promise that resolves when the data has been saved</p>
<h2 id="examples-25"><a class="header" href="#examples-25">Examples</a></h2>
<h3 id="basic-data-saving"><a class="header" href="#basic-data-saving">Basic Data Saving</a></h3>
<pre><code class="language-typescript">import {preferences} from '@homunculus/sdk';

// Save simple values
await preferences.save('username', 'Alice');
await preferences.save('last-login', new Date().toISOString());
await preferences.save('session-count', 42);
await preferences.save('tutorial-completed', true);

console.log('User data saved');
</code></pre>
<h2 id="related-functions-16"><a class="header" href="#related-functions-16">Related Functions</a></h2>
<ul>
<li><a href="sdk/preferences/./load.html"><code>load()</code></a> - Load stored preferences with type safety</li>
<li><a href="sdk/preferences/./loadVrmTransform.html"><code>loadVrmTransform()</code></a> - Load VRM character positions</li>
<li><a href="sdk/preferences/./saveVrmTransform.html"><code>saveVrmTransform()</code></a> - Save VRM character positions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vrm-transform-persistence"><a class="header" href="#vrm-transform-persistence">VRM Transform Persistence</a></h1>
<p>VRM Transform Persistence provides specialized functions for saving and loading VRM character positions, rotations, and
scales. These convenience functions simplify the process of remembering where users positioned their characters across
application sessions.</p>
<h2 id="overview-7"><a class="header" href="#overview-7">Overview</a></h2>
<p>The VRM transform system uses the character's name as a key to store and retrieve transform data. This makes it easy to
restore character positions when the application starts, or save them when characters are moved.</p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h4 id="loadvrmtransform"><a class="header" href="#loadvrmtransform">loadVrmTransform</a></h4>
<p>Loads a previously saved VRM character transform (position, rotation, scale) by character name.</p>
<p>Vrm's transform is automatically saved when the app exits, and this function retrieves the saved it.</p>
<p>This convenience function retrieves the transform (position, rotation, scale) for a specific VRM character. Unlike the
generic <code>load()</code> function, this method provides a default identity transform instead of throwing an error when no saved
data exists, making it safe to use without error handling.</p>
<h2 id="parameters-31"><a class="header" href="#parameters-31">Parameters</a></h2>
<ul>
<li><code>vrmName</code> (string) - The name of the VRM character</li>
</ul>
<h2 id="returns-25"><a class="header" href="#returns-25">Returns</a></h2>
<p><code>Promise&lt;Transform&gt;</code> - A promise that resolves to the saved transform, or default identity transform if none exists</p>
<h3 id="savevrmtransform"><a class="header" href="#savevrmtransform">saveVrmTransform</a></h3>
<p>Saves a VRM character's transform (position, rotation, scale) for later restoration.</p>
<p>This convenience function stores the position, rotation, and scale of a VRM character so it can be restored in future
sessions. This is useful for remembering where users positioned their characters after dragging or programmatic
movement.</p>
<h4 id="parameters-32"><a class="header" href="#parameters-32">Parameters</a></h4>
<ul>
<li><code>vrmName</code> (string) - The name of the VRM character</li>
<li><code>transform</code> (Transform) - The transform data to save</li>
</ul>
<h4 id="returns-26"><a class="header" href="#returns-26">Returns</a></h4>
<p><code>Promise&lt;void&gt;</code> - A promise that resolves when the transform has been saved</p>
<h2 id="quick-example-5"><a class="header" href="#quick-example-5">Quick Example</a></h2>
<pre><code class="language-typescript">import {preferences, Vrm, entities} from '@homunculus/sdk';

// Save a character's current position
const vrm = await Vrm.findByName('MyCharacter');
const currentTransform = await entities.transform(vrm.entity);
await preferences.saveVrmTransform('MyCharacter', currentTransform);

// Later, restore the character's position
const savedTransform = await preferences.loadVrmTransform('MyCharacter');
await entities.setTransform(vrm.entity, savedTransform);
</code></pre>
<h2 id="common-patterns"><a class="header" href="#common-patterns">Common Patterns</a></h2>
<h3 id="startup-restoration"><a class="header" href="#startup-restoration">Startup Restoration</a></h3>
<p>Restore all character positions when the application starts:</p>
<pre><code class="language-typescript">const characterNames = ['Alice', 'Bob', 'Charlie'];

for (const name of characterNames) {
    try {
        const vrm = await Vrm.findByName(name);
        const savedTransform = await preferences.loadVrmTransform(name);
        await entities.setTransform(vrm.entity, savedTransform);
    } catch (error) {
        console.log(`Could not restore ${name}`);
    }
}
</code></pre>
<h3 id="auto-save-on-movement"><a class="header" href="#auto-save-on-movement">Auto-save on Movement</a></h3>
<p>Save character positions automatically when they're moved:</p>
<pre><code class="language-typescript">const vrm = await Vrm.spawn('characters/assistant.vrm');
const events = vrm.events();

events.on('drag-end', async () =&gt; {
    const name = await vrm.name();
    const transform = await entities.transform(vrm.entity);
    await preferences.saveVrmTransform(name, transform);
});
</code></pre>
<h2 id="related-functions-17"><a class="header" href="#related-functions-17">Related Functions</a></h2>
<ul>
<li><a href="sdk/preferences/./load.html"><code>load()</code></a> - Load stored preferences with type safety</li>
<li><a href="sdk/preferences/./save.html"><code>save()</code></a> - Save data to the preferences store</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="settings-api"><a class="header" href="#settings-api">Settings API</a></h1>
<p>The Settings API provides access to core application configuration and performance settings. It allows you to control application behavior, optimize performance for different hardware configurations, and adjust settings that affect the user experience.</p>
<h2 id="key-features-4"><a class="header" href="#key-features-4">Key Features</a></h2>
<ul>
<li><strong>Frame Rate Control</strong>: Manage FPS limits for performance optimization</li>
<li><strong>Real-time Updates</strong>: Changes take effect immediately without application restart</li>
<li><strong>Performance Optimization</strong>: Adjust settings based on hardware capabilities</li>
<li><strong>Power Management</strong>: Optimize for battery life or maximum performance</li>
</ul>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<ul>
<li><a href="sdk/settings/./fpsLimit.html"><code>fpsLimit()</code></a> - Get the current frame rate limit</li>
<li><a href="sdk/settings/./saveFpsLimit.html"><code>saveFpsLimit()</code></a> - Set the frame rate limit</li>
</ul>
<h2 id="quick-example-6"><a class="header" href="#quick-example-6">Quick Example</a></h2>
<pre><code class="language-typescript">// Check current FPS setting
const currentFps = await settings.fpsLimit();
console.log(`Current FPS limit: ${currentFps}`);

// Optimize for high-end hardware
await settings.saveFpsLimit(120);

// Optimize for battery life
await settings.saveFpsLimit(30);

// Dynamic adjustment based on conditions
const vrms = await Vrm.findAll();
const targetFps = vrms.length &gt; 3 ? 30 : 60;
await settings.saveFpsLimit(targetFps);
</code></pre>
<h2 id="common-use-cases-12"><a class="header" href="#common-use-cases-12">Common Use Cases</a></h2>
<ul>
<li><strong>Performance Optimization</strong>: Adjust FPS based on scene complexity</li>
<li><strong>Battery Management</strong>: Lower FPS to extend battery life on mobile devices</li>
<li><strong>Display Matching</strong>: Match application FPS to display refresh rate</li>
<li><strong>Hardware Adaptation</strong>: Automatically adjust settings based on system capabilities</li>
<li><strong>Power Saving</strong>: Reduce rendering load during idle periods</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frame-rate-limit"><a class="header" href="#frame-rate-limit">Frame Rate Limit</a></h1>
<p>The frame rate limit is a crucial performance setting that determines the maximum number of frames the application will
render per second. This setting helps optimize performance for different hardware configurations and can be used to
extend battery life on mobile devices or match display refresh rates.</p>
<h2 id="settingsfpslimit"><a class="header" href="#settingsfpslimit">settings.fpsLimit()</a></h2>
<p>Gets the current frame rate limit setting for the application.</p>
<p>The FPS limit controls how many frames per second the application will render, which directly affects performance, power
consumption, and visual smoothness. This function returns the currently configured maximum frame rate.</p>
<h3 id="parameters-33"><a class="header" href="#parameters-33">Parameters</a></h3>
<p>None.</p>
<h3 id="returns-27"><a class="header" href="#returns-27">Returns</a></h3>
<p><code>Promise&lt;number&gt;</code> - The current FPS limit setting</p>
<h2 id="settingssavefpslimitfps-number"><a class="header" href="#settingssavefpslimitfps-number">settings.saveFpsLimit(fps: number)</a></h2>
<p>Sets the frame rate limit for the application with immediate effect.</p>
<p>This setting controls the maximum number of frames rendered per second, directly affecting performance, power
consumption, and visual smoothness. Changes take effect immediately without requiring an application restart.</p>
<h3 id="parameters-34"><a class="header" href="#parameters-34">Parameters</a></h3>
<ul>
<li><code>fps</code>: The maximum frames per second to target</li>
</ul>
<h3 id="returns-28"><a class="header" href="#returns-28">Returns</a></h3>
<p><code>Promise&lt;void&gt;</code> - Resolves when the setting has been applied</p>
<h2 id="examples-26"><a class="header" href="#examples-26">Examples</a></h2>
<h3 id="basic-fps-checking"><a class="header" href="#basic-fps-checking">Basic FPS Checking</a></h3>
<pre><code class="language-typescript">// Check current setting
const fps = await settings.fpsLimit();
console.log(`Current FPS limit: ${fps}`);

// Use in conditional logic
if (fps &lt; 60) {
    console.log("Performance mode is enabled");
} else {
    console.log("High quality mode is enabled");
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripts-execution"><a class="header" href="#scripts-execution">Scripts Execution</a></h1>
<p>Provides functionality to execute scripts placed in <code>assets/mods</code> directory.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript-execution"><a class="header" href="#javascript-execution">JavaScript Execution</a></h1>
<p>Calls a Javascript(or Typescript) file located in assets/mods.</p>
<p>The script will be called on the built-in Deno runtime.
When the Javascript file being executed is changed, a hot reload will occur, and it will be re-executed.</p>
<h2 id="parameters-35"><a class="header" href="#parameters-35">Parameters</a></h2>
<ul>
<li>source (string): The path to the script file relative to <code>assets/mods</code>.</li>
</ul>
<h2 id="returns-29"><a class="header" href="#returns-29">Returns</a></h2>
<p><code>Promise&lt;void&gt;</code> - A promise that resolves when the script has been executed.</p>
<h2 id="examples-27"><a class="header" href="#examples-27">Examples</a></h2>
<pre><code class="language-typescript">import {scripts} from '@homunculus/sdk';

await scripts.callJavascript("my-mod/my-script.js");
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shadow-panel"><a class="header" href="#shadow-panel">Shadow Panel</a></h1>
<p>The shadow panel represents the shadow displayed behind the character.
It internally places the transparent plane behind avatars and applies a special shader to project only the shadow of
avatars.</p>
<p>This API provides methods to control the shadow panel's visibility and properties.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alpha-control"><a class="header" href="#alpha-control">Alpha Control</a></h1>
<h2 id="shadowpanelalpha"><a class="header" href="#shadowpanelalpha">shadowPanel.alpha</a></h2>
<p>Fetches the current shadow panel's alpha value.(0-1)</p>
<h3 id="parameters-36"><a class="header" href="#parameters-36">Parameters</a></h3>
<p>None</p>
<h3 id="returns-30"><a class="header" href="#returns-30">Returns</a></h3>
<p><code>Promise&lt;number&gt;</code> - A promise that resolves to the current alpha value of the shadow panel.</p>
<h2 id="shadowpanelsetalpha"><a class="header" href="#shadowpanelsetalpha">shadowPanel.setAlpha</a></h2>
<p>Sets the shadow panel's alpha value.(0-1)</p>
<p>The value is saved to storage and will persist across application restarts.</p>
<h3 id="parameters-37"><a class="header" href="#parameters-37">Parameters</a></h3>
<ul>
<li><code>alpha</code> (number) - The new alpha value to set for the shadow panel. Must be between 0 and 1.</li>
</ul>
<h3 id="returns-31"><a class="header" href="#returns-31">Returns</a></h3>
<p><code>Promise&lt;void&gt;</code> - A promise that resolves when the alpha value has been successfully set.</p>
<h3 id="examples-28"><a class="header" href="#examples-28">Examples</a></h3>
<pre><code class="language-typescript">import {shadowPanel} from '@homunculus/sdk';

// Set shadow panel to 50% opacity
await shadowPanel.setAlpha(0.5);
// Fetch the current alpha value
console.log(await shadowPanel.alpha());
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mod-metadata"><a class="header" href="#mod-metadata">MOD Metadata</a></h1>
<p>Provides access to mod metadata and discovery functionality within Desktop Homunculus.</p>
<h2 id="related-documentation-13"><a class="header" href="#related-documentation-13">Related Documentation</a></h2>
<ul>
<li><strong><a href="sdk/mods/../scripts/index.html">Scripts</a></strong> - Executing mod JavaScript files</li>
<li><strong><a href="sdk/mods/../webviews/index.html">Webview Management</a></strong> - Creating mod interfaces</li>
<li><strong><a href="sdk/mods/../commands/index.html">Commands System</a></strong> - Inter-mod communication</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retrieve-mod-menus"><a class="header" href="#retrieve-mod-menus">Retrieve MOD Menus</a></h1>
<p>Retrieves all registered MOD menus metadata.</p>
<h2 id="parameters-38"><a class="header" href="#parameters-38">Parameters</a></h2>
<p>None</p>
<h2 id="returns-32"><a class="header" href="#returns-32">Returns</a></h2>
<p><code>Promise&lt;ModMenuMetadata&gt;</code> - A promise that resolves when the data has been saved</p>
<h2 id="modmenumetadata"><a class="header" href="#modmenumetadata">ModMenuMetadata</a></h2>
<h3 id="thumbnail"><a class="header" href="#thumbnail">thumbnail</a></h3>
<p>Optional path to a thumbnail image for the mod.
The path should be relative to the mod's asset directory.</p>
<h3 id="text"><a class="header" href="#text">text</a></h3>
<p>Display name for the mod that appears in the menu.
This is the human-readable title users will see.</p>
<h3 id="script"><a class="header" href="#script">script</a></h3>
<p>The script local path relative to the mod's asset directory.</p>
<h3 id="webview"><a class="header" href="#webview">webview</a></h3>
<p>Optional webview configuration for how the mod should be displayed.
If not specified, default webview settings will be used.</p>
<h2 id="examples-29"><a class="header" href="#examples-29">Examples</a></h2>
<h3 id="basic-data-saving-1"><a class="header" href="#basic-data-saving-1">Basic Data Saving</a></h3>
<pre><code class="language-typescript">import {mods} from '@homunculus/sdk';

const modMenus = await mods.menus();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="math-types-and-utilities"><a class="header" href="#math-types-and-utilities">Math Types and Utilities</a></h1>
<p>The Math module provides TypeScript interfaces and types for mathematical concepts used throughout the Desktop
Homunculus SDK. These types ensure type safety and consistency when working with 3D graphics, spatial calculations, and
geometric operations.</p>
<h2 id="overview-8"><a class="header" href="#overview-8">Overview</a></h2>
<p>All mathematical types in this module are designed to be compatible with Bevy's math system and follow standard 3D
graphics conventions. The types provide a clean, typed interface for:</p>
<ul>
<li><strong>3D Transformations</strong>: Position, rotation, and scale in 3D space</li>
<li><strong>Vector Operations</strong>: 2D and 3D vector mathematics</li>
<li><strong>Geometric Shapes</strong>: Rectangles and bounds for UI and effects</li>
<li><strong>Coordinate Systems</strong>: Consistent representation across different spaces</li>
</ul>
<h2 id="available-types"><a class="header" href="#available-types">Available Types</a></h2>
<h3 id="core-types"><a class="header" href="#core-types">Core Types</a></h3>
<ul>
<li><strong><a href="sdk/math/./Transform.html">Transform</a></strong> - Complete 3D transformation with position, rotation, and scale</li>
<li><strong><a href="sdk/math/./Vec2.html">Vec2</a></strong> - 2D vector for screen coordinates and 2D math</li>
<li><strong><a href="sdk/math/./Vec3.html">Vec3</a></strong> - 3D vector for world positions and directions</li>
<li><strong><a href="sdk/math/./Rect.html">Rect</a></strong> - 2D rectangle defined by min/max points</li>
</ul>
<h2 id="coordinate-system-conventions"><a class="header" href="#coordinate-system-conventions">Coordinate System Conventions</a></h2>
<h3 id="3d-world-space"><a class="header" href="#3d-world-space">3D World Space</a></h3>
<ul>
<li><strong>X-axis</strong>: Left (-) to Right (+)</li>
<li><strong>Y-axis</strong>: Down (-) to Up (+)</li>
<li><strong>Z-axis</strong>: Forward (+) to Backward (-)</li>
<li><strong>Rotation</strong>: Quaternions in [x, y, z, w] format</li>
</ul>
<h3 id="2d-screen-space"><a class="header" href="#2d-screen-space">2D Screen Space</a></h3>
<ul>
<li><strong>X-axis</strong>: Left (0) to Right (screen width)</li>
<li><strong>Y-axis</strong>: Top (0) to Bottom (screen height)</li>
<li><strong>Origin</strong>: Top-left corner of screen</li>
</ul>
<h2 id="related-documentation-14"><a class="header" href="#related-documentation-14">Related Documentation</a></h2>
<ul>
<li><a href="sdk/math/../cameras/index.html">Cameras</a> - Coordinate system transformations</li>
<li><a href="sdk/math/../entities/index.html">Entities</a> - 3D object manipulation using transforms</li>
<li><a href="sdk/math/../effects/index.html">Effects</a> - Uses Rect for positioning effects</li>
<li><a href="sdk/math/../webviews/index.html">Webviews</a> - Uses Vec2 for UI positioning</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transform-2"><a class="header" href="#transform-2">Transform</a></h1>
<p>Represents a complete 3D transformation containing position, rotation, and scale components. This is the core type for
positioning and orienting objects in 3D space throughout the Desktop Homunculus ecosystem.</p>
<h2 id="type-definition"><a class="header" href="#type-definition">Type Definition</a></h2>
<pre><code class="language-typescript">interface Transform {
    translation: [number, number, number];
    rotation: [number, number, number, number];
    scale: [number, number, number];
}
</code></pre>
<h2 id="properties"><a class="header" href="#properties">Properties</a></h2>
<ul>
<li><strong>translation</strong>: Position in world space as [x, y, z] coordinates</li>
<li><strong>rotation</strong>: Orientation as a quaternion in [x, y, z, w] format</li>
<li><strong>scale</strong>: Size multiplier as [x, y, z] values (1.0 = normal size)</li>
</ul>
<h2 id="examples-30"><a class="header" href="#examples-30">Examples</a></h2>
<h3 id="identity-transform"><a class="header" href="#identity-transform">Identity Transform</a></h3>
<pre><code class="language-typescript">// Default transform - no translation, rotation, or scaling
const identity: Transform = {
    translation: [0, 0, 0],
    rotation: [0, 0, 0, 1],
    scale: [1, 1, 1]
};
</code></pre>
<h3 id="positioning-vrm-characters"><a class="header" href="#positioning-vrm-characters">Positioning VRM Characters</a></h3>
<pre><code class="language-typescript">// Place VRM 50 units forward and 100 units up
const characterPosition: Transform = {
    translation: [0, 100, 50],
    rotation: [0, 0, 0, 1],    // No rotation
    scale: [1, 1, 1]           // Normal size
};

await Deno.api.entities.setTransform(vrmEntity, characterPosition);
</code></pre>
<h2 id="partial-updates"><a class="header" href="#partial-updates">Partial Updates</a></h2>
<p>You can provide partial transforms to update only specific components:</p>
<pre><code class="language-typescript">// Update only position
const newPosition: Partial&lt;Transform&gt; = {
    translation: [100, 0, 0]
};
await Deno.api.entities.setTransform(entity, newPosition);

// Update only rotation
const newRotation: Partial&lt;Transform&gt; = {
    rotation: [0, 0.707, 0, 0.707]
};
await Deno.api.entities.setTransform(entity, newRotation);

// Update position and scale, keep rotation
const positionAndScale: Partial&lt;Transform&gt; = {
    translation: [50, 100, 0],
    scale: [1.5, 1.5, 1.5]
};
await Deno.api.entities.setTransform(entity, positionAndScale);
</code></pre>
<h2 id="working-with-entity-transforms"><a class="header" href="#working-with-entity-transforms">Working with Entity Transforms</a></h2>
<h3 id="getting-current-transform"><a class="header" href="#getting-current-transform">Getting Current Transform</a></h3>
<pre><code class="language-typescript">// Get the current transform of an entity
const currentTransform = await Deno.api.entities.transform(entityId);
console.log('Position:', currentTransform.translation);
console.log('Rotation:', currentTransform.rotation);
console.log('Scale:', currentTransform.scale);
</code></pre>
<h3 id="modifying-existing-transforms"><a class="header" href="#modifying-existing-transforms">Modifying Existing Transforms</a></h3>
<pre><code class="language-typescript">// Move entity relative to current position
const current = await Deno.api.entities.transform(entityId);
const moved: Transform = {
    translation: [
        current.translation[0] + 50,  // Move 50 units right
        current.translation[1],       // Keep Y position
        current.translation[2] + 25   // Move 25 units forward
    ],
    rotation: current.rotation,     // Keep rotation
    scale: current.scale           // Keep scale
};

await Deno.api.entities.setTransform(entityId, moved);
</code></pre>
<h2 id="related-types"><a class="header" href="#related-types">Related Types</a></h2>
<ul>
<li><strong><a href="sdk/math/./Vec3.html">Vec3</a></strong> - Used internally for translation and scale vectors</li>
<li><strong><a href="sdk/math/./Vec2.html">Vec2</a></strong> - Used for 2D positioning operations</li>
<li><strong><a href="sdk/math/./Rect.html">Rect</a></strong> - Used for 2D bounds and regions</li>
</ul>
<h2 id="related-documentation-15"><a class="header" href="#related-documentation-15">Related Documentation</a></h2>
<ul>
<li><a href="sdk/math/../entities/index.html">Entities</a> - Primary interface for manipulating transforms</li>
<li><a href="sdk/math/../vrm/index.html">VRM</a> - VRM characters use transforms for positioning</li>
<li><a href="sdk/math/../cameras/index.html">Cameras</a> - Convert between coordinate systems</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vec2"><a class="header" href="#vec2">Vec2</a></h1>
<p>Represents a 2D vector with x and y components. Used throughout the SDK for screen coordinates, UI positioning, 2D
mathematical operations, and coordinate system conversions.</p>
<h2 id="type-definition-1"><a class="header" href="#type-definition-1">Type Definition</a></h2>
<pre><code class="language-typescript">interface Vec2 {
    x: number;
    y: number;
}
</code></pre>
<h2 id="properties-1"><a class="header" href="#properties-1">Properties</a></h2>
<ul>
<li><strong>x</strong>: The horizontal coordinate or x-component of the vector</li>
<li><strong>y</strong>: The vertical coordinate or y-component of the vector</li>
</ul>
<h2 id="examples-31"><a class="header" href="#examples-31">Examples</a></h2>
<h3 id="basic-usage-4"><a class="header" href="#basic-usage-4">Basic Usage</a></h3>
<pre><code class="language-typescript">// Screen coordinates
const mousePosition: Vec2 = {x: 150, y: 200};
const screenCenter: Vec2 = {x: 1920 / 2, y: 1080 / 2};

// 2D offset or direction
const offset: Vec2 = {
    x: mousePosition.x - screenCenter.x,
    y: mousePosition.y - screenCenter.y
};
</code></pre>
<h2 id="related-types-1"><a class="header" href="#related-types-1">Related Types</a></h2>
<ul>
<li><strong><a href="sdk/math/./Vec3.html">Vec3</a></strong> - 3D vector extension of Vec2</li>
<li><strong><a href="sdk/math/./Transform.html">Transform</a></strong> - Uses Vec3 internally for translation</li>
<li><strong><a href="sdk/math/./Rect.html">Rect</a></strong> - Uses Vec2 concepts for 2D bounds</li>
</ul>
<h2 id="related-documentation-16"><a class="header" href="#related-documentation-16">Related Documentation</a></h2>
<ul>
<li><a href="sdk/math/../cameras/index.html">Cameras</a> - Coordinate system conversions using Vec2</li>
<li><a href="sdk/math/../effects/index.html">Effects</a> - 2D positioning for visual effects</li>
<li><a href="sdk/math/../webviews/index.html">Webviews</a> - UI positioning and layout</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vec3"><a class="header" href="#vec3">Vec3</a></h1>
<p>Represents a 3D vector with x, y, and z components. Used throughout the SDK for 3D positions, directions, mathematical
calculations, and spatial operations in the 3D world space.</p>
<h2 id="type-definition-2"><a class="header" href="#type-definition-2">Type Definition</a></h2>
<pre><code class="language-typescript">interface Vec3 {
    x: number;
    y: number;
    z: number;
}
</code></pre>
<h2 id="properties-2"><a class="header" href="#properties-2">Properties</a></h2>
<ul>
<li><strong>x</strong>: The x-coordinate or x-component of the vector (left/right)</li>
<li><strong>y</strong>: The y-coordinate or y-component of the vector (down/up)</li>
<li><strong>z</strong>: The z-coordinate or z-component of the vector (forward/backward)</li>
</ul>
<h2 id="examples-32"><a class="header" href="#examples-32">Examples</a></h2>
<h3 id="basic-usage-5"><a class="header" href="#basic-usage-5">Basic Usage</a></h3>
<pre><code class="language-typescript">// 3D world positions
const worldPosition: Vec3 = {x: 10, y: 50, z: -20};
const characterPos: Vec3 = {x: 0, y: 0, z: 100};

// Direction vectors
const upDirection: Vec3 = {x: 0, y: 1, z: 0};
const forwardDirection: Vec3 = {x: 0, y: 0, z: 1};
const rightDirection: Vec3 = {x: 1, y: 0, z: 0};

// Velocity and movement
const velocity: Vec3 = {x: 1.5, y: 0, z: 2.0};
</code></pre>
<h2 id="related-types-2"><a class="header" href="#related-types-2">Related Types</a></h2>
<ul>
<li><strong><a href="sdk/math/./Vec2.html">Vec2</a></strong> - 2D vector counterpart</li>
<li><strong><a href="sdk/math/./Transform.html">Transform</a></strong> - Uses Vec3 for translation and scale</li>
<li><strong><a href="sdk/math/./Rect.html">Rect</a></strong> - 2D bounds complementing 3D vectors</li>
</ul>
<h2 id="related-documentation-17"><a class="header" href="#related-documentation-17">Related Documentation</a></h2>
<ul>
<li><a href="sdk/math/../entities/index.html">Entities</a> - 3D object manipulation using Vec3</li>
<li><a href="sdk/math/../cameras/index.html">Cameras</a> - Coordinate conversions with Vec3</li>
<li><a href="sdk/math/../vrm/index.html">VRM</a> - Character positioning and bone operations</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rect"><a class="header" href="#rect">Rect</a></h1>
<p>Represents a 2D rectangle defined by minimum and maximum points. Used throughout the SDK for viewport bounds, UI
regions, effect positioning, and screen area definitions.</p>
<h2 id="type-definition-3"><a class="header" href="#type-definition-3">Type Definition</a></h2>
<pre><code class="language-typescript">interface Rect {
    min: [number, number];
    max: [number, number];
}
</code></pre>
<h2 id="properties-3"><a class="header" href="#properties-3">Properties</a></h2>
<ul>
<li><strong>min</strong>: Bottom-left corner coordinates as [x, y]</li>
<li><strong>max</strong>: Top-right corner coordinates as [x, y]</li>
</ul>
<h2 id="examples-33"><a class="header" href="#examples-33">Examples</a></h2>
<h3 id="basic-usage-6"><a class="header" href="#basic-usage-6">Basic Usage</a></h3>
<pre><code class="language-typescript">// Screen viewport definition
const viewport: Rect = {
    min: [0, 0],        // Bottom-left corner
    max: [1920, 1080]   // Top-right corner
};

// UI element bounds
const buttonBounds: Rect = {
    min: [100, 50],     // Left: 100px, Bottom: 50px
    max: [300, 150]     // Right: 300px, Top: 150px
};

// Effect area
const explosionArea: Rect = {
    min: [400, 300],
    max: [600, 500]
};
</code></pre>
<h2 id="related-types-3"><a class="header" href="#related-types-3">Related Types</a></h2>
<ul>
<li><strong><a href="sdk/math/./Vec2.html">Vec2</a></strong> - Used for rectangle corners and dimensions</li>
<li><strong><a href="sdk/math/./Vec3.html">Vec3</a></strong> - Can be projected to screen space for Rect creation</li>
<li><strong><a href="sdk/math/./Transform.html">Transform</a></strong> - 3D entities can be bounded by screen Rects</li>
</ul>
<h2 id="related-documentation-18"><a class="header" href="#related-documentation-18">Related Documentation</a></h2>
<ul>
<li><a href="sdk/math/../effects/index.html">Effects</a> - Uses Rect for positioning visual effects</li>
<li><a href="sdk/math/../webviews/index.html">Webviews</a> - Uses Rect concepts for UI bounds</li>
<li><a href="sdk/math/../cameras/index.html">Cameras</a> - Projects 3D coordinates to screen Rects</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utilities"><a class="header" href="#utilities">Utilities</a></h1>
<p>The Utilities module provides helper functions for common operations and runtime detection throughout the Desktop
Homunculus SDK. These utility functions support timing operations, environment detection, and other frequently needed
functionality.</p>
<h2 id="overview-9"><a class="header" href="#overview-9">Overview</a></h2>
<p>The utilities module includes essential helper functions that make MOD development more convenient and efficient. These
utilities handle cross-platform concerns and provide consistent APIs for common operations.</p>
<h3 id="key-features-5"><a class="header" href="#key-features-5">Key Features</a></h3>
<ul>
<li><strong>Timing Control</strong>: Sleep function for introducing delays and controlling execution flow</li>
<li><strong>Runtime Detection</strong>: Automatic detection of JavaScript execution environment</li>
<li><strong>Cross-Platform Support</strong>: Consistent behavior across browser, Node.js, and Deno environments</li>
<li><strong>Development Helpers</strong>: Utilities for debugging and development workflows</li>
</ul>
<h2 id="available-functions"><a class="header" href="#available-functions">Available Functions</a></h2>
<h3 id="core-utilities"><a class="header" href="#core-utilities">Core Utilities</a></h3>
<ul>
<li><strong><a href="sdk/utilities/./sleep.html">sleep</a></strong> - Pauses execution for specified milliseconds</li>
<li><strong><a href="sdk/utilities/./runtime.html">runtime</a></strong> - Detects current JavaScript runtime environment</li>
</ul>
<h2 id="basic-usage-7"><a class="header" href="#basic-usage-7">Basic Usage</a></h2>
<h3 id="delaying-execution"><a class="header" href="#delaying-execution">Delaying Execution</a></h3>
<pre><code class="language-typescript">// Simple delay
console.log('Starting...');
await Deno.api.functions.sleep(2000);
console.log('2 seconds later!');
</code></pre>
<h2 id="related-documentation-19"><a class="header" href="#related-documentation-19">Related Documentation</a></h2>
<ul>
<li><a href="sdk/utilities/../commands/index.html">Commands</a> - Event timing and debouncing</li>
<li><a href="sdk/utilities/../vrm/index.html">VRM</a> - Animation sequencing and timing</li>
<li><a href="sdk/utilities/../effects/index.html">Effects</a> - Visual effect timing and synchronization</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sleep"><a class="header" href="#sleep">sleep</a></h1>
<p>Pauses execution for the specified number of milliseconds.
This utility function wraps setTimeout in a Promise, allowing for async/await syntax when you need to introduce delays
in your MOD code.</p>
<h2 id="parameters-39"><a class="header" href="#parameters-39">Parameters</a></h2>
<ul>
<li><strong>ms</strong> (number): Number of milliseconds to pause execution</li>
</ul>
<h2 id="returns-33"><a class="header" href="#returns-33">Returns</a></h2>
<p>A Promise that resolves after the specified time has elapsed.</p>
<h2 id="examples-34"><a class="header" href="#examples-34">Examples</a></h2>
<h3 id="basic-usage-8"><a class="header" href="#basic-usage-8">Basic Usage</a></h3>
<pre><code class="language-typescript">// Simple delay
console.log('Starting...');
await Deno.api.functions.sleep(2000);
console.log('2 seconds later!');
</code></pre>
<h2 id="related-functions-18"><a class="header" href="#related-functions-18">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/utilities/./runtime.html">runtime</a></strong> - Environment detection for timing behavior</li>
<li><a href="sdk/utilities/../commands/index.html">Commands</a> - Event timing and throttling</li>
<li><a href="sdk/utilities/../effects/index.html">Effects</a> - Visual effect timing and synchronization</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="runtime"><a class="header" href="#runtime">runtime</a></h1>
<p>Detects the current JavaScript runtime environment.
This function helps determine whether the SDK is running in a browser, Node.js, or Deno environment, enabling
conditional logic and environment-specific optimizations.</p>
<h2 id="parameters-40"><a class="header" href="#parameters-40">Parameters</a></h2>
<p>None</p>
<h2 id="returns-34"><a class="header" href="#returns-34">Returns</a></h2>
<p>A string literal indicating the detected runtime environment:</p>
<ul>
<li><code>"browser"</code> - Running in a web browser environment</li>
<li><code>"nodejs"</code> - Running in Node.js environment</li>
<li><code>"deno"</code> - Running in Deno environment</li>
</ul>
<h2 id="examples-35"><a class="header" href="#examples-35">Examples</a></h2>
<h3 id="basic-usage-9"><a class="header" href="#basic-usage-9">Basic Usage</a></h3>
<pre><code class="language-typescript">const env = Deno.api.functions.runtime();
console.log(`Running in ${env} environment`);

switch (env) {
    case 'browser':
        console.log('Browser environment detected');
        break;
    case 'nodejs':
        console.log('Node.js environment detected');
        break;
    case 'deno':
        console.log('Deno environment detected');
        break;
}
</code></pre>
<h2 id="related-functions-19"><a class="header" href="#related-functions-19">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/utilities/./sleep.html">sleep</a></strong> - Timing behavior may vary across runtimes</li>
<li><a href="sdk/utilities/../preferences/index.html">Preferences</a> - Storage mechanisms differ by runtime</li>
<li><a href="sdk/utilities/../commands/index.html">Commands</a> - Event handling varies by environment</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-communication"><a class="header" href="#host-communication">Host Communication</a></h1>
<p>The Host API namespace provides low-level HTTP communication with the Desktop Homunculus server. This module handles the
foundational HTTP client functionality used internally by all other SDK modules.</p>
<h2 id="overview-10"><a class="header" href="#overview-10">Overview</a></h2>
<blockquote>
<p>[!Note]
This module is primarily for internal SDK use.</p>
<p>Most MOD developers should use the higher-level namespaces like <code>gpt</code>,
<code>vrm</code>, <code>commands</code>, etc., rather than calling host functions directly.</p>
</blockquote>
<p>The host module provides:</p>
<ul>
<li>Base URL configuration for the Desktop Homunculus server</li>
<li>URL construction utilities with query parameter support</li>
<li>HTTP methods (GET, POST, PUT) with automatic error handling</li>
<li>Type-safe response handling</li>
</ul>
<h2 id="base-configuration"><a class="header" href="#base-configuration">Base Configuration</a></h2>
<p>The host module connects to the Desktop Homunculus server running on:</p>
<ul>
<li><strong>Base URL</strong>: <code>http://localhost:3100</code></li>
<li><strong>Protocol</strong>: HTTP with JSON content type</li>
<li><strong>Error Handling</strong>: Automatic status code validation</li>
</ul>
<h2 id="available-functions-1"><a class="header" href="#available-functions-1">Available Functions</a></h2>
<h3 id="core-functions"><a class="header" href="#core-functions">Core Functions</a></h3>
<ul>
<li><strong><a href="sdk/host/./createUrl.html">createUrl</a></strong> - Creates URLs with optional query parameters</li>
<li><strong><a href="sdk/host/./get.html">get</a></strong> - Performs GET requests with error handling</li>
<li><strong><a href="sdk/host/./post.html">post</a></strong> - Performs POST requests with JSON payload</li>
<li><strong><a href="sdk/host/./put.html">put</a></strong> - Performs PUT requests with JSON payload</li>
</ul>
<h2 id="basic-usage-10"><a class="header" href="#basic-usage-10">Basic Usage</a></h2>
<p>While you typically won't use the host module directly, understanding its patterns can help with debugging and advanced
use cases:</p>
<pre><code class="language-typescript">// Internal SDK usage example
const response = await Deno.api.host.get(
    Deno.api.host.createUrl("vrm/all")
);
const vrms = await response.json();

// URL construction with parameters
const url = Deno.api.host.createUrl("gpt/model", {vrm: 123});
// Results in: http://localhost:3100/gpt/model?vrm=123
</code></pre>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<p>All host functions automatically validate HTTP response status codes and throw detailed errors for failed requests:</p>
<pre><code class="language-typescript">try {
    const response = await Deno.api.host.get(url);
    const data = await response.json();
} catch (error) {
    // Error includes URL, status, and response text
    console.error('Request failed:', error.message);
}
</code></pre>
<h2 id="internal-architecture"><a class="header" href="#internal-architecture">Internal Architecture</a></h2>
<p>The host module serves as the foundation layer for all SDK communication:</p>
<ol>
<li><strong>URL Construction</strong>: Builds properly formatted API endpoints</li>
<li><strong>Request Headers</strong>: Sets appropriate content types and headers</li>
<li><strong>Error Detection</strong>: Validates response status codes</li>
<li><strong>Type Safety</strong>: Ensures consistent response handling</li>
</ol>
<h2 id="when-to-use-direct-host-access"><a class="header" href="#when-to-use-direct-host-access">When to Use Direct Host Access</a></h2>
<p>You might need direct host access in these scenarios:</p>
<ul>
<li><strong>Custom API Endpoints</strong>: Accessing undocumented or experimental endpoints</li>
<li><strong>Raw Response Data</strong>: When you need the raw Response object</li>
<li><strong>Advanced Error Handling</strong>: Custom error processing requirements</li>
<li><strong>Performance Optimization</strong>: Bypassing higher-level abstractions</li>
</ul>
<h2 id="related-documentation-20"><a class="header" href="#related-documentation-20">Related Documentation</a></h2>
<ul>
<li><a href="sdk/host/../commands/index.html">Commands</a> - Built on host for real-time communication</li>
<li><a href="sdk/host/../gpt/index.html">GPT Integration</a> - Uses host for AI chat requests</li>
<li><a href="sdk/host/../vrm/index.html">VRM Management</a> - Uses host for character operations</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-url"><a class="header" href="#create-url">Create URL</a></h1>
<p>Creates a URL for the Desktop Homunculus API with optional query parameters.</p>
<h2 id="parameters-41"><a class="header" href="#parameters-41">Parameters</a></h2>
<ul>
<li><strong>path</strong> (string): The API endpoint path (relative to base URL)</li>
<li><strong>params</strong> (object, optional): Query parameters to append to the URL</li>
</ul>
<h2 id="returns-35"><a class="header" href="#returns-35">Returns</a></h2>
<p>A URL instance ready for use in HTTP requests, pointing to <code>http://localhost:3100/{path}</code>.</p>
<h2 id="examples-36"><a class="header" href="#examples-36">Examples</a></h2>
<h3 id="simple-path"><a class="header" href="#simple-path">Simple Path</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("vrm/all");
// Result: http://localhost:3100/vrm/all
</code></pre>
<h3 id="with-query-parameters"><a class="header" href="#with-query-parameters">With Query Parameters</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("entities", {
    name: "VRM",
    root: 123
});
// Result: http://localhost:3100/entities?name=VRM&amp;root=123
</code></pre>
<h2 id="related-functions-20"><a class="header" href="#related-functions-20">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/host/./get.html">get</a></strong> - Uses created URLs for GET requests</li>
<li><strong><a href="sdk/host/./post.html">post</a></strong> - Uses created URLs for POST requests</li>
<li><strong><a href="sdk/host/./put.html">put</a></strong> - Uses created URLs for PUT requests</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-request"><a class="header" href="#get-request">GET Request</a></h1>
<p>Performs a GET request to the specified URL with automatic error handling.</p>
<h2 id="parameters-42"><a class="header" href="#parameters-42">Parameters</a></h2>
<ul>
<li><strong>url</strong> (URL): The URL to send the GET request to (typically created with <code>createUrl</code>)</li>
</ul>
<h2 id="returns-36"><a class="header" href="#returns-36">Returns</a></h2>
<p>A Promise that resolves to the Response object if successful.</p>
<h2 id="throws"><a class="header" href="#throws">Throws</a></h2>
<p>Will throw an error if the response status is not ok (status &gt;= 400).</p>
<h2 id="examples-37"><a class="header" href="#examples-37">Examples</a></h2>
<h3 id="basic-get-request"><a class="header" href="#basic-get-request">Basic GET Request</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("vrm/all");
const response = await Deno.api.host.get(url);
const vrms = await response.json();

console.log('Available VRMs:', vrms);
</code></pre>
<h3 id="get-with-query-parameters"><a class="header" href="#get-with-query-parameters">GET with Query Parameters</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("entities", {
    name: "MyCharacter"
});
const response = await Deno.api.host.get(url);
const entities = await response.json();
</code></pre>
<h3 id="error-handling-1"><a class="header" href="#error-handling-1">Error Handling</a></h3>
<pre><code class="language-typescript">try {
    const url = Deno.api.host.createUrl("vrm/999"); // Non-existent VRM
    const response = await Deno.api.host.get(url);
    const data = await response.json();
} catch (error) {
    console.error('GET request failed:', error.message);
    // Error message includes URL, status, and response text
}
</code></pre>
<h2 id="related-functions-21"><a class="header" href="#related-functions-21">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/host/./createUrl.html">createUrl</a></strong> - Creates URLs for GET requests</li>
<li><strong><a href="sdk/host/./post.html">post</a></strong> - POST requests with request body</li>
<li><strong><a href="sdk/host/./put.html">put</a></strong> - PUT requests for updates</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="post-request"><a class="header" href="#post-request">POST Request</a></h1>
<p>Performs a POST request with JSON payload and automatic error handling.</p>
<h2 id="parameters-43"><a class="header" href="#parameters-43">Parameters</a></h2>
<ul>
<li><strong>url</strong> (URL): The URL to send the POST request to (typically created with <code>createUrl</code>)</li>
<li><strong>body</strong> (any, optional): Request body that will be JSON-serialized</li>
</ul>
<h2 id="returns-37"><a class="header" href="#returns-37">Returns</a></h2>
<p>A Promise that resolves to the Response object if successful.</p>
<h2 id="throws-1"><a class="header" href="#throws-1">Throws</a></h2>
<p>Will throw an error if the response status is not ok (status &gt;= 400).</p>
<h2 id="examples-38"><a class="header" href="#examples-38">Examples</a></h2>
<h3 id="basic-post-request"><a class="header" href="#basic-post-request">Basic POST Request</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("gpt/chat");
const response = await Deno.api.host.post(url, {
    userMessage: "Hello!",
    options: {vrm: 123}
});
const chatResponse = await response.json();
</code></pre>
<h3 id="post-without-body"><a class="header" href="#post-without-body">POST without Body</a></h3>
<pre><code class="language-typescript">// Empty body POST request
const url = Deno.api.host.createUrl("system/reset");
const response = await Deno.api.host.post(url);
const result = await response.json();
</code></pre>
<h2 id="related-functions-22"><a class="header" href="#related-functions-22">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/host/./createUrl.html">createUrl</a></strong> - Creates URLs for POST requests</li>
<li><strong><a href="sdk/host/./get.html">get</a></strong> - GET requests for retrieving data</li>
<li><strong><a href="sdk/host/./put.html">put</a></strong> - PUT requests for updates</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="put-request"><a class="header" href="#put-request">PUT Request</a></h1>
<p>Performs a PUT request with JSON payload and automatic error handling.</p>
<h2 id="parameters-44"><a class="header" href="#parameters-44">Parameters</a></h2>
<ul>
<li><strong>url</strong> (URL): The URL to send the PUT request to (typically created with <code>createUrl</code>)</li>
<li><strong>body</strong> (any, optional): Request body that will be JSON-serialized</li>
</ul>
<h2 id="returns-38"><a class="header" href="#returns-38">Returns</a></h2>
<p>A Promise that resolves to the Response object if successful.</p>
<h2 id="throws-2"><a class="header" href="#throws-2">Throws</a></h2>
<p>Will throw an error if the response status is not ok (status &gt;= 400).</p>
<h2 id="examples-39"><a class="header" href="#examples-39">Examples</a></h2>
<h3 id="basic-put-request"><a class="header" href="#basic-put-request">Basic PUT Request</a></h3>
<pre><code class="language-typescript">const url = Deno.api.host.createUrl("gpt/model");
const response = await Deno.api.host.put(url, {
    model: "gpt-4",
    vrm: 123
});
const result = await response.json();
</code></pre>
<h2 id="related-functions-23"><a class="header" href="#related-functions-23">Related Functions</a></h2>
<ul>
<li><strong><a href="sdk/host/./createUrl.html">createUrl</a></strong> - Creates URLs for PUT requests</li>
<li><strong><a href="sdk/host/./get.html">get</a></strong> - GET requests for retrieving current state</li>
<li><strong><a href="sdk/host/./post.html">post</a></strong> - POST requests for creating resources</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
